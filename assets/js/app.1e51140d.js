(function(){"use strict";var e={1868:function(e,t,a){a.d(t,{U:function(){return i}});var r=a(4291),o="production",l="prod",n={dev:{api:"",web:"https://www.haigeek.com/developercenter/static/develop.html#/"},test:{api:"",web:"https://www.haigeek.com/developercenter/static/develop.html#/"},prod:{api:"",web:"https://www.haigeek.com/developercenter/static/develop.html#/"},apikaifa:"https://stp.haier.net/mock/290"};"development"===o&&(n={dev:{api:"/apidev",web:"https://www.haigeek.com/developercenter/static/develop.html#/"},test:{api:"/apitest",web:"https://www.haigeek.com/developercenter/static/develop.html#/"},prod:{api:"/apiprod",web:"https://www.haigeek.com/developercenter/static/develop.html#/"},apikaifa:"https://stp.haier.net/mock/290"});n[l];var i=function(e,t,a,o){return"get"===e.toLowerCase()?r.iotAxios.get(n[l].api+t,{params:a},o).catch((function(e){e.status})):r.iotAxios.post(n[l].api+t,a,o).catch((function(e){e.status}))}},719:function(e,t,a){a.d(t,{K3:function(){return l},kq:function(){return r},nk:function(){return o},yo:function(){return n}});var r="zoom",o="fullScreen",l="save",n="disabled"},5991:function(e,t,a){a.d(t,{B:function(){return g},U:function(){return f}});var r=a(3634),o=a(3230),l=a(1186),n=a(3645),i=function(e){e.bindKey(["meta+c","ctrl+c"],(function(){var t=e.getSelectedCells();return t.length&&e.copy(t),!1}))},s=function(e){e.bindKey(["meta+v","ctrl+v"],(function(){if(!e.isClipboardEmpty()){var t=e.paste({offset:32});e.cleanSelection(),e.select(t)}return!1}))},u=function(e){e.bindKey(["meta+x","ctrl+x"],(function(){var t=e.getSelectedCells();return t.length&&e.cut(t),!1}))},c=function(e){e.bindKey(["meta+z","ctrl+z"],(function(){return e.canUndo()&&e.undo(),!1}))},d=function(e){e.bindKey(["meta+shift+z","ctrl+shift+z"],(function(){return e.canRedo()&&e.redo(),!1}))},m=function(e){e.bindKey(["backspace","delete"],(function(){var t=e.getSelectedCells();t.length&&e.removeCells(t)}))},p=a(8711),h=a(4023),v=a(5959),g=function(e){var t=new r.kJ(e);return t.use(new o.H({enabled:!0})),t.use(new p.Y({enabled:!0,multiple:!0,rubberband:!0,movable:!0,showNodeSelectionBox:!0})),t.use(new h.T({enabled:!0})),t.use(new n.N({enabled:!0})),t.use(new v.A({enabled:!0})),t.use(new l.D),t},f=function(e,t){t.forEach((function(t){switch(t){case"copy":i(e);break;case"paste":s(e);break;case"cut":u(e);break;case"undo":c(e);break;case"redo":d(e);break;case"delete":m(e);break;default:break}}))}},8917:function(e,t,a){a.d(t,{d:function(){return l},m:function(){return o}});var r=a(4082),o=function(e){var t=new r.q({target:e});return t},l=function(e){var t=e.graph,a=e.dnd,r=e.event,o=e.options,l=e.data,n=t.createNode(o);return n.setData(l),a.start(n,r),n}},6454:function(e,t,a){a.d(t,{Jl:function(){return n},Kg:function(){return u},O:function(){return s},RR:function(){return i},lz:function(){return c},n2:function(){return d}});var r=a(692),o=a(3997),l=a(8503),n=[{className:"设备条件",classCode:"equipment",children:[{description:"设备条件",name:"equipment",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.Iu},port:{templates:[o.gF,o.QX]},attr:{template:l.hP}}]},{className:"定时条件",classCode:"time",children:[]},{className:"天气条件",classCode:"weather",children:[]},{className:"地理围栏条件",classCode:"geofence",children:[]}],i=[{className:"决策点",classCode:"descision",children:[{id:"descision",name:r.Bu,description:"决策节点",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.Bu},port:{templates:[o.gF,o.QX]},attr:{template:l.lG}}]},{className:"逻辑关系",classCode:"relation",children:[{id:"andId",name:"or",description:"并行节点",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.WH},port:{templates:[o.Kc]}},{id:"andId",name:"and",description:"会签节点",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.WH},port:{templates:[o.Kc]}},{id:"serialId",name:"serial",description:"串行节点",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.WH},port:{templates:[o.Kc]}}]}],s=[{className:"决策组",classCode:"descisionGroup",children:[{id:"descisionGroup",name:r.xf,description:"决策组",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.xf},attr:{template:l.AN}}]}],u=[{className:"设备动作",classCode:"equipmentActioin",children:[{id:"prodTypeActionId",name:"prodTypeAction",description:"设备执行",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.Iu},port:{templates:[o.jo]},attr:{template:l.Hd}}]},{className:"消息动作",classCode:"messageGroup",children:[{id:"messageId",name:"messagePush",description:"消息通知",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.Iu},port:{templates:[o.jo]},attr:{template:l._0}}]},{className:"延时动作",classCode:"delayGroup",children:[]}],c=(r.Xn,r.Xn,r.Xn,r.Xn,r.Xn,r.Xn,r.Xn,r.Xn,{className:"网关",classCode:"gateway",children:[{id:"Exclusive",name:r.gn,description:"互斥网关",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.gn},attr:{template:l.Hd}},{id:"Parallel",name:r.gn,description:"并行网关",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.gn}}]}),d={className:"任务",classCode:"gateway",children:[{id:"User",name:r.Xn,description:"人工任务",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.Xn}},{id:"Service",name:r.Xn,description:"服务任务",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.Xn}},{id:"Receive",name:r.Xn,description:"接受任务",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.Xn}},{id:"Service",name:r.Xn,description:"调用活动",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:{template:r.Xn}}]}},9275:function(e,t,a){var r=a(8222);function o(e,t){const a=(0,r.resolveComponent)("router-view");return(0,r.openBlock)(),(0,r.createElementBlock)("div",null,[(0,r.createVNode)(a)])}var l=a(3744);const n={},i=(0,l.Z)(n,[["render",o]]);var s=i,u=a(655),c=a(2201),d=a(5781),m=function(e){return(0,r.pushScopeId)("data-v-2f96ffc7"),e=e(),(0,r.popScopeId)(),e},p={class:"common-block"},h=m((function(){return(0,r.createElementVNode)("h5",{class:"mb-2"},"haigeek",-1)})),v=m((function(){return(0,r.createElementVNode)("span",null,"场景流程",-1)})),g=m((function(){return(0,r.createElementVNode)("span",null,"决策组",-1)})),f=m((function(){return(0,r.createElementVNode)("span",null,"决策点",-1)})),y=(0,r.defineComponent)({__name:"index",setup:function(e){var t=(0,c.tv)(),a=(0,c.yj)(),o=function(e,t){console.log(e,t)},l=function(e,t){console.log(e,t)},n=function(e){t.push(e)};return function(e,t){var i=(0,r.resolveComponent)("el-icon"),s=(0,r.resolveComponent)("el-menu-item"),u=(0,r.resolveComponent)("document"),c=(0,r.resolveComponent)("el-menu"),m=(0,r.resolveComponent)("el-col"),y=(0,r.resolveComponent)("el-row"),k=(0,r.resolveComponent)("router-view");return(0,r.openBlock)(),(0,r.createElementBlock)("div",p,[(0,r.withDirectives)((0,r.createVNode)(y,{class:"tac"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(m,{span:24},{default:(0,r.withCtx)((function(){return[h,(0,r.createVNode)(c,{"default-active":"2",class:"el-menu-vertical-demo",onOpen:o,onClose:l,onSelect:n},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(s,{index:"flow-list"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(i,null,{default:(0,r.withCtx)((function(){return[(0,r.createVNode)((0,r.unref)(d.Menu))]})),_:1}),v]})),_:1}),(0,r.createVNode)(s,{index:"descision-group-list"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(i,null,{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(u)]})),_:1}),g]})),_:1}),(0,r.createVNode)(s,{index:"descision-node-list"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(i,null,{default:(0,r.withCtx)((function(){return[(0,r.createVNode)((0,r.unref)(d.Location))]})),_:1}),f]})),_:1})]})),_:1})]})),_:1})]})),_:1},512),[[r.vShow,!(0,r.unref)(a).meta.hideMenu]]),(0,r.createVNode)(k)])}}});const k=(0,l.Z)(y,[["__scopeId","data-v-2f96ffc7"]]);var V=k,C=["src"],F=(0,r.createElementVNode)("p",{style:{"font-size":"16px",margin:"-5px 0 15px"}},"链接桩配置",-1),S=(0,r.createElementVNode)("p",{style:{"font-size":"16px",margin:"-5px 0 15px"}},"属性配置",-1),b=(0,r.defineComponent)({__name:"configComponent",setup:function(e){var t=this,a=(0,r.ref)("default"),o=(0,r.ref)(),l=(0,r.reactive)({name:"",description:"",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:"",region:"",count:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""}),n=(0,r.reactive)({name:[{required:!0,message:"Please input 组件名称",trigger:"blur"}],shape:[{required:!0,message:"Please select Activity zone",trigger:"change"}],count:[{required:!0,message:"Please select Activity count",trigger:"change"}],type:[{type:"array",required:!0,message:"Please select at least one activity type",trigger:"change"}]}),i=function(e){return(0,u.mG)(t,void 0,void 0,(function(){return(0,u.Jh)(this,(function(t){switch(t.label){case 0:return e?[4,e.validate((function(e,t){if(console.log(l),e){console.log("submit!");var a={name:l.name,icon:l.icon,description:l.name,shape:{template:l.shape},port:{templates:l.type}},r=JSON.parse(localStorage.getItem("config")||"[]");r.push(a),localStorage.setItem("config",JSON.stringify(r))}else console.log("error submit!",t)}))]:[2];case 1:return t.sent(),[2]}}))}))},s=function(e){e&&e.resetFields()};return function(e,t){var u=(0,r.resolveComponent)("el-input"),c=(0,r.resolveComponent)("el-form-item"),d=(0,r.resolveComponent)("el-option"),m=(0,r.resolveComponent)("el-select"),p=(0,r.resolveComponent)("el-divider"),h=(0,r.resolveComponent)("el-switch"),v=(0,r.resolveComponent)("el-checkbox"),g=(0,r.resolveComponent)("el-checkbox-group"),f=(0,r.resolveComponent)("el-button"),y=(0,r.resolveComponent)("el-form");return(0,r.openBlock)(),(0,r.createBlock)(y,{ref_key:"ruleFormRef",ref:o,model:l,rules:n,"label-width":"120px",class:"demo-ruleForm",size:a.value,"status-icon":""},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(c,{label:"组件名称",prop:"description"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(u,{modelValue:l.description,"onUpdate:modelValue":t[0]||(t[0]=function(e){return l.description=e})},null,8,["modelValue"])]})),_:1}),(0,r.createVNode)(c,{label:"组件标识",prop:"name"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(u,{modelValue:l.name,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.name=e})},null,8,["modelValue"])]})),_:1}),(0,r.createVNode)(c,{label:"组件图标",prop:"icon"},{default:(0,r.withCtx)((function(){return[(0,r.createElementVNode)("img",{src:l.icon,alt:""},null,8,C)]})),_:1}),(0,r.createVNode)(c,{label:"UI容器",prop:"region"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(m,{modelValue:l.shape,"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.shape=e}),placeholder:"Activity zone"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(d,{label:"基础模板",value:"basic-node"}),(0,r.createVNode)(d,{label:"Zone two",value:"beijing"})]})),_:1},8,["modelValue"])]})),_:1}),(0,r.createVNode)(p),F,(0,r.createVNode)(c,{label:"使用模板",prop:"delivery"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(h,{modelValue:l.delivery,"onUpdate:modelValue":t[3]||(t[3]=function(e){return l.delivery=e})},null,8,["modelValue"])]})),_:1}),(0,r.createVNode)(c,{label:"链接桩模板",prop:"type"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(g,{modelValue:l.type,"onUpdate:modelValue":t[4]||(t[4]=function(e){return l.type=e})},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(v,{label:"conditionInPort",name:"type"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" 条件输入节点 ")]})),_:1}),(0,r.createVNode)(v,{label:"conditionOutPort",name:"type"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" 条件输出节点 ")]})),_:1}),(0,r.createVNode)(v,{label:"actionInPort",name:"type"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" 动作输入节点 ")]})),_:1}),(0,r.createVNode)(v,{label:"actionOutPort",name:"type"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" 动作输出节点 ")]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),S,(0,r.createVNode)(c,null,{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(f,{type:"primary",onClick:t[5]||(t[5]=function(e){return i(o.value)})},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" 创建 ")]})),_:1}),(0,r.createVNode)(f,{onClick:t[6]||(t[6]=function(e){return s(o.value)})},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Reset")]})),_:1})]})),_:1})]})),_:1},8,["model","rules","size"])}}});const N=b;var w=N,x=(0,r.createElementVNode)("p",{style:{"font-size":"16px",margin:"-5px 0 15px"}},"连接桩规则配置",-1),B=(0,r.defineComponent)({__name:"portComponent",setup:function(e){var t=this,a=(0,r.ref)("default"),o=(0,r.ref)(),l=(0,r.reactive)({name:"",description:"",icon:"https://resource.haigeek.com/download/resource/selfService/portal/img/41899b4c118d410687b0c199375cc39b.png",shape:"",region:"",count:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""}),n=(0,r.reactive)({name:[{required:!0,message:"Please input 组件名称",trigger:"blur"}],shape:[{required:!0,message:"Please select Activity zone",trigger:"change"}],count:[{required:!0,message:"Please select Activity count",trigger:"change"}],type:[{type:"array",required:!0,message:"Please select at least one activity type",trigger:"change"}]}),i=function(e){return(0,u.mG)(t,void 0,void 0,(function(){return(0,u.Jh)(this,(function(t){switch(t.label){case 0:return e?[4,e.validate((function(e,t){if(console.log(l),e){console.log("submit!");var a={name:l.name,icon:l.icon,description:l.name,shape:{template:l.shape},port:{templates:l.type}},r=JSON.parse(localStorage.getItem("config")||"[]");r.push(a),localStorage.setItem("config",JSON.stringify(r))}else console.log("error submit!",t)}))]:[2];case 1:return t.sent(),[2]}}))}))},s=function(e){e&&e.resetFields()};return function(e,t){var u=(0,r.resolveComponent)("el-input"),c=(0,r.resolveComponent)("el-form-item"),d=(0,r.resolveComponent)("el-option"),m=(0,r.resolveComponent)("el-select"),p=(0,r.resolveComponent)("el-divider"),h=(0,r.resolveComponent)("el-checkbox"),v=(0,r.resolveComponent)("el-checkbox-group"),g=(0,r.resolveComponent)("el-button"),f=(0,r.resolveComponent)("el-form");return(0,r.openBlock)(),(0,r.createBlock)(f,{ref_key:"ruleFormRef",ref:o,model:l,rules:n,"label-width":"120px",class:"demo-ruleForm",size:a.value,"status-icon":""},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(c,{label:"连接桩名称",prop:"description"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(u,{modelValue:l.description,"onUpdate:modelValue":t[0]||(t[0]=function(e){return l.description=e})},null,8,["modelValue"])]})),_:1}),(0,r.createVNode)(c,{label:"连接桩标识",prop:"name"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(u,{modelValue:l.name,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.name=e})},null,8,["modelValue"])]})),_:1}),(0,r.createVNode)(c,{label:"连接桩位置",prop:"region"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(m,{modelValue:l.shape,"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.shape=e}),placeholder:"Activity zone"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(d,{label:"上",value:"top"}),(0,r.createVNode)(d,{label:"下",value:"bottom"}),(0,r.createVNode)(d,{label:"左",value:"left"}),(0,r.createVNode)(d,{label:"右",value:"right"})]})),_:1},8,["modelValue"])]})),_:1}),(0,r.createVNode)(c,{label:"连接桩样式配置",prop:"icon"}),(0,r.createVNode)(p),x,(0,r.createVNode)(c,{label:"链接桩模板",prop:"type"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(v,{modelValue:l.type,"onUpdate:modelValue":t[3]||(t[3]=function(e){return l.type=e})},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(h,{label:"conditionInPort",name:"type"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" 条件输入节点 ")]})),_:1}),(0,r.createVNode)(h,{label:"conditionOutPort",name:"type"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" 条件输出节点 ")]})),_:1}),(0,r.createVNode)(h,{label:"actionInPort",name:"type"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" 动作输入节点 ")]})),_:1}),(0,r.createVNode)(h,{label:"actionOutPort",name:"type"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" 动作输出节点 ")]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,r.createVNode)(c,null,{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(g,{type:"primary",onClick:t[4]||(t[4]=function(e){return i(o.value)})},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" 创建 ")]})),_:1}),(0,r.createVNode)(g,{onClick:t[5]||(t[5]=function(e){return s(o.value)})},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Reset")]})),_:1})]})),_:1})]})),_:1},8,["model","rules","size"])}}});const D=B;var L=D,_=(0,r.defineComponent)({__name:"index",setup:function(e){var t=(0,r.ref)("first"),a=function(e,t){console.log(e,t)};return function(e,o){var l=(0,r.resolveComponent)("el-tab-pane"),n=(0,r.resolveComponent)("el-tabs");return(0,r.openBlock)(),(0,r.createBlock)(n,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=function(e){return t.value=e}),type:"card",class:"demo-tabs",onTabClick:a},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(l,{label:"添加组件",name:"first"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(w)]})),_:1}),(0,r.createVNode)(l,{label:"添加连接桩",name:"second"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(L)]})),_:1}),(0,r.createVNode)(l,{label:"Role",name:"third"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Role")]})),_:1}),(0,r.createVNode)(l,{label:"Task",name:"fourth"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Task")]})),_:1})]})),_:1},8,["modelValue"])}}});const T=_;var q=T,E=a(8917),P=a(5991),O=a(8116),I=a(6941);function A(){var e=(0,r.ref)(),t=(0,r.ref)();return(0,r.onMounted)((function(){e.value=(0,I.j)({templateName:O.ef,container:document.getElementById("container")}),t.value=(0,E.m)(e.value),(0,P.U)(e.value,["copy","paste","cut","undo","redo","delete"])})),{graph:e,dnd:t}}var $=a(3927),J=a(6454),M={class:"material-content"},U=["onMousedown"],j=["src"],H=(0,r.defineComponent)({__name:"materialComponent",props:{graph:null,dnd:null},setup:function(e){var t=e,a=[J.lz,J.n2],o=[];a.forEach((function(e){o.push.apply(o,e.children)})),(0,$.Z)(o);var l=function(e,a){t.graph&&t.dnd&&(0,E.d)({graph:t.graph,dnd:t.dnd,event:e,options:{shape:a.name},data:(0,u.pi)({},a)})},n=(0,r.ref)(["gateway","task"]),i=function(){console.log("world")};return function(e,t){var o=(0,r.resolveComponent)("el-collapse-item"),s=(0,r.resolveComponent)("el-collapse");return(0,r.openBlock)(),(0,r.createElementBlock)("div",M,[(0,r.createVNode)(s,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=function(e){return n.value=e}),onChange:i},{default:(0,r.withCtx)((function(){return[((0,r.openBlock)(),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(a,(function(e){return(0,r.createVNode)(o,{title:e.className,name:e.classCode,key:e.classCode},{default:(0,r.withCtx)((function(){return[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.children,(function(e){return(0,r.openBlock)(),(0,r.createElementBlock)("div",{class:"menu-item",key:e.id,onMousedown:function(t){return l(t,e)}},[(0,r.createElementVNode)("img",{src:e.icon},null,8,j),(0,r.createElementVNode)("div",null,(0,r.toDisplayString)(e.description),1)],40,U)})),128))]})),_:2},1032,["title","name"])})),64))]})),_:1},8,["modelValue"])])}}});const R=(0,l.Z)(H,[["__scopeId","data-v-1ec282a1"]]);var z=R,Z=a(7489),W=a(719),G=a(1803),K={class:"attribute-block"},X={class:"attribute-title"},Q=["src"],Y=(0,r.defineComponent)({__name:"index",props:{node:null},setup:function(e){var t=e,a=(0,r.computed)((function(){return o.value.attr?(0,G.E)(o.value.attr):null})),o=(0,r.computed)((function(){return t.node&&t.node.data||{}}));return function(e,t){return(0,r.openBlock)(),(0,r.createElementBlock)("div",K,[(0,r.createElementVNode)("div",X,[(0,r.createElementVNode)("img",{src:(0,r.unref)(o).icon,alt:""},null,8,Q),(0,r.createElementVNode)("h4",null,(0,r.toDisplayString)((0,r.unref)(o).description),1)]),(0,r.unref)(a)?((0,r.openBlock)(),(0,r.createBlock)((0,r.resolveDynamicComponent)((0,r.unref)(a)),(0,r.normalizeProps)((0,r.mergeProps)({key:0},e.$attrs)),null,16)):(0,r.createCommentVNode)("",!0)])}}});const ee=(0,l.Z)(Y,[["__scopeId","data-v-1ea7eba8"]]);var te=ee,ae=a(1348);function re(e,t){var a=t.name,r=t.query.id,o=!1;if("createDescisionNode"===a){var l=JSON.parse(localStorage.getItem("descisionNode")||"{}");l[r]=e,localStorage.setItem("descisionNode",JSON.stringify(l)),o=!0}if("createDescisionGroup"===a){var n=JSON.parse(localStorage.getItem("descisionGroup")||"{}");n[r]=e,console.log("当前决策组内容是",e),localStorage.setItem("descisionGroup",JSON.stringify(n)),o=!0}if("createFlow"===a){var i=JSON.parse(localStorage.getItem("flow")||"{}");i[r]=e,localStorage.setItem("flow",JSON.stringify(i)),o=!0}o&&(0,ae.z8)({message:"保存成功",type:"success"})}var oe=a(692),le=a(2681),ne=function(e){return(0,r.pushScopeId)("data-v-b09a3fca"),e=e(),(0,r.popScopeId)(),e},ie={class:"home"},se={class:"menu-bar"},ue={class:"canvas-card"},ce=ne((function(){return(0,r.createElementVNode)("div",{id:"container"},null,-1)})),de={class:"attrs-bar"},me=(0,r.defineComponent)({__name:"index",setup:function(e){var t=(0,c.yj)(),a=(0,le.kR)(),o=A(),l=o.graph,n=o.dnd,i=(0,r.ref)(),s=(0,r.ref)(),d=function(){l.value&&l.value.removeNode(i.value),i.value=void 0},m=function(e){if(i.value)if(i.value.shape===oe.xf)i.value.attr("text/text",e.descision);else{var t=i.value.getData();i.value.setData((0,u.pi)((0,u.pi)({},t),{attrData:e}))}},p=function(e){console.log("保存的数据是",e),re(e,t,l.value)},h=[W.kq,W.nk,W.K3,W.yo],v=function(e,t){for(var a=0,r=e.length;a<r;a+=1)e[a].style.visibility=t?"visible":"hidden"};return(0,r.onMounted)((function(){l.value&&n.value&&(l.value.on("node:click",(function(e){var t=e.view,a=e.node;s.value&&s.value.classList.remove("active"),s.value=t.container.querySelector(".basic-node")||void 0,s.value&&s.value.classList.add("active"),i.value?i.value!==a?i.value=a:i.value=void 0:i.value=a})),l.value.on("blank:click",(function(){i.value=void 0,s.value&&s.value.classList.remove("active")})),l.value.on("node:mouseenter",(function(){var e=document.getElementById("container"),t=e.querySelectorAll(".x6-port-body");v(t,!0)})),l.value.on("node:mouseleave",(function(){var e=document.getElementById("container"),t=e.querySelectorAll(".x6-port-body");v(t,!1)})))})),function(e,t){return(0,r.openBlock)(),(0,r.createElementBlock)("div",ie,[(0,r.createElementVNode)("div",se,[(0,r.createVNode)(z,{graph:(0,r.unref)(l),dnd:(0,r.unref)(n)},null,8,["graph","dnd"])]),(0,r.createElementVNode)("div",ue,[(0,r.createElementVNode)("header",null,[(0,r.createVNode)(Z.Z,{tools:h,graph:(0,r.unref)(l),dnd:(0,r.unref)(n),onSaveData:p},null,8,["graph","dnd"])]),ce,(0,r.createVNode)((0,r.unref)(a))]),(0,r.withDirectives)((0,r.createElementVNode)("div",de,[(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(te,{key:(0,r.unref)(i)&&(0,r.unref)(i).id,node:(0,r.unref)(i),onSyncData:m,onDelNode:d},null,8,["node"])),[[r.vShow,(0,r.unref)(i)]])],512),[[r.vShow,(0,r.unref)(i)]])])}}});const pe=(0,l.Z)(me,[["__scopeId","data-v-b09a3fca"]]);var he=pe,ve=function(e){return(0,r.pushScopeId)("data-v-06dd2138"),e=e(),(0,r.popScopeId)(),e},ge={class:"rules-block"},fe={class:"common-title"},ye=ve((function(){return(0,r.createElementVNode)("h3",null,"决策列表",-1)})),ke=(0,r.defineComponent)({__name:"descisionNode",setup:function(e){var t=(0,c.tv)(),a=(0,r.ref)(JSON.parse(localStorage.getItem("descisionNodeList")||"[]")),o=function(){var e=prompt("请输入决策点名称");e&&(a.value.push({id:"".concat(a.value.length+1),name:e}),localStorage.setItem("descisionNodeList",JSON.stringify(a.value)))},l=function(e){t.push({name:"createDescisionNode",query:{id:e.id,name:e.name}})},n=function(e){t.push({name:"rulesDetail",query:{id:e.id}})};return function(e,t){var i=(0,r.resolveComponent)("el-button"),s=(0,r.resolveComponent)("el-table-column"),u=(0,r.resolveComponent)("el-table");return(0,r.openBlock)(),(0,r.createElementBlock)("div",ge,[(0,r.createElementVNode)("div",fe,[ye,(0,r.createVNode)(i,{onClick:o},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("新建决策点")]})),_:1})]),(0,r.createVNode)(u,{data:a.value,style:{width:"100%"}},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(s,{prop:"name",label:"决策点名称",width:"180"}),(0,r.createVNode)(s,{prop:"createTime",label:"创建时间",width:"180"}),(0,r.createVNode)(s,{prop:"modifyTime",label:"修改时间",width:"180"}),(0,r.createVNode)(s,{prop:"modifyTime",label:"是否启用",width:"180"}),(0,r.createVNode)(s,{fixed:"right",label:"操作",width:"180"},{default:(0,r.withCtx)((function(e){return[(0,r.createVNode)(i,{link:"",type:"primary",size:"small",onClick:function(t){return n(e.row)}},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("详情")]})),_:2},1032,["onClick"]),(0,r.createVNode)(i,{link:"",type:"primary",size:"small",onClick:function(t){return l(e.row)}},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" 编辑 ")]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"])])}}});const Ve=(0,l.Z)(ke,[["__scopeId","data-v-06dd2138"]]);var Ce=Ve,Fe=a(8358),Se=function(e){return(0,r.pushScopeId)("data-v-19493b1e"),e=e(),(0,r.popScopeId)(),e},be={class:"rules-block"},Ne={class:"common-title"},we=Se((function(){return(0,r.createElementVNode)("h3",null,"决策组列表",-1)})),xe=(0,r.defineComponent)({__name:"descisionGroup",setup:function(e){var t=(0,c.tv)(),a=(0,r.ref)(JSON.parse(localStorage.getItem("descisionGroupList")||"[]")),o=function(){var e=prompt("请输入决策组名称");e&&(a.value.push({id:"".concat(a.value.length+1),name:e}),localStorage.setItem("descisionGroupList",JSON.stringify(a.value)))},l=function(e){t.push({name:"createDescisionGroup",query:{id:e.id,name:e.name}})},n=function(e){t.push({name:"rulesDetail",query:{id:e.id}})};return function(e,t){var i=(0,r.resolveComponent)("el-button"),s=(0,r.resolveComponent)("el-table-column"),u=(0,r.resolveComponent)("el-table");return(0,r.openBlock)(),(0,r.createElementBlock)("div",be,[(0,r.createElementVNode)("div",Ne,[we,(0,r.createVNode)(i,{onClick:o},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("新建决策组")]})),_:1})]),(0,r.createVNode)(u,{data:a.value,style:{width:"100%"}},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(s,{prop:"name",label:"决策组名称",width:"180"}),(0,r.createVNode)(s,{prop:"createTime",label:"创建时间",width:"180"}),(0,r.createVNode)(s,{prop:"modifyTime",label:"修改时间",width:"180"}),(0,r.createVNode)(s,{prop:"modifyTime",label:"是否启用",width:"180"}),(0,r.createVNode)(s,{fixed:"right",label:"操作",width:"180"},{default:(0,r.withCtx)((function(e){return[(0,r.createVNode)(i,{link:"",type:"primary",size:"small",onClick:function(t){return n(e.row)}},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("详情")]})),_:2},1032,["onClick"]),(0,r.createVNode)(i,{link:"",type:"primary",size:"small",onClick:function(t){return l(e.row)}},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" 编辑 ")]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"])])}}});const Be=(0,l.Z)(xe,[["__scopeId","data-v-19493b1e"]]);var De=Be,Le=[{path:"/descision-node-list",name:"descisionNodeList",component:Ce},{path:"/create-descision-node",name:"createDescisionNode",component:Fe["default"],meta:{hideMenu:!0}},{path:"/descision-detail",name:"descisionDetail",component:Fe["default"],meta:{hideMenu:!0}},{path:"/descision-group-list",name:"descisionGroupList",component:De},{path:"/create-descision-group",name:"createDescisionGroup",component:Fe["default"],meta:{hideMenu:!0}}],_e=[{path:"/flow-list",name:"flow-list",component:function(){return a.e(239).then(a.bind(a,3288))}},{path:"/create-flow",name:"createFlow",component:function(){return a.e(239).then(a.bind(a,8358))},meta:{hideMenu:!0}},{path:"/flow-detail",name:"flowDetail",component:function(){return a.e(239).then(a.bind(a,8358))},meta:{hideMenu:!0}}],Te=[{path:"/logic-flow-list",name:"logic-flow-list",component:function(){return a.e(624).then(a.bind(a,5121))}},{path:"/create-logic-flow",name:"createLogicFlow",component:function(){return a.e(624).then(a.bind(a,3623))},meta:{hideMenu:!0}},{path:"/logic-flow-detail",name:"logicFlowDetail",component:function(){return a.e(624).then(a.bind(a,3623))},meta:{hideMenu:!0}}],qe=(0,u.ev)((0,u.ev)([{path:"/scene",name:"scene",component:he},{path:"/",name:"home",component:V,children:(0,u.ev)((0,u.ev)([],Le,!0),_e,!0)}],Te,!0),[{path:"/config",name:"config",component:q}],!1),Ee=(0,c.p7)({history:(0,c.r5)(),routes:qe}),Pe=Ee,Oe=a(3907),Ie=(0,Oe.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}}),Ae=a(5260),$e=(a(4415),a(544)),Je=(0,r.createApp)(s);Je.use(Ae.Z,{locale:$e.Z}).use(Ie).use(Pe).mount("#app");for(var Me=0,Ue=Object.entries(d);Me<Ue.length;Me++){var je=Ue[Me],He=je[0],Re=je[1];Je.component(He,Re)}},8503:function(e,t,a){a.d(t,{AN:function(){return o},HT:function(){return i},Hd:function(){return u},_0:function(){return c},fg:function(){return n},hI:function(){return s},hP:function(){return l},lG:function(){return r},m8:function(){return d}});var r="descision",o="descisionGroup",l="equipmentAttr",n="time",i="weather",s="FENCE",u="equipmentActionAttr",c="messageActionAttr",d="messageActionAttr"},1803:function(e,t,a){a.d(t,{E:function(){return Ee}});var r=a(655),o=a(8503),l=a(8222);function n(e,t){(0,l.watch)(t,(function(){console.log("sdfe"),e("syncData",t)}),{deep:!0})}var i=a(6486),s=(0,l.defineComponent)({__name:"attrDescision",emits:["syncData"],setup:function(e,t){var a=this,o=t.emit,s=function(e){console.log(e);var t=(0,i.find)(u,(function(t){return t.id===e}));m.descision=t.name},u=JSON.parse(localStorage.getItem("descisionNodeList")||"[]");console.log(u),(0,l.onMounted)((function(){n(o,m)}));var c=(0,l.ref)("default"),d=(0,l.ref)(),m=(0,l.reactive)({name:"Hello",descisionId:"",descision:"",count:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""}),p=(0,l.reactive)({name:[{required:!0,message:"Please input Activity name",trigger:"blur"},{min:3,max:5,message:"Length should be 3 to 5",trigger:"blur"}],descisionId:[{required:!0,message:"Please select Activity zone",trigger:"change"}],count:[{required:!0,message:"Please select Activity count",trigger:"change"}],date1:[{type:"date",required:!0,message:"Please pick a date",trigger:"change"}],date2:[{type:"date",required:!0,message:"Please pick a time",trigger:"change"}],type:[{type:"array",required:!0,message:"Please select at least one activity type",trigger:"change"}],resource:[{required:!0,message:"Please select activity resource",trigger:"change"}],desc:[{required:!0,message:"Please input activity form",trigger:"blur"}]}),h=function(e){return(0,r.mG)(a,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return e?[4,e.validate((function(e,t){e?console.log("submit!"):console.log("error submit!",t)}))]:[2];case 1:return t.sent(),[2]}}))}))},v=function(e){e&&e.resetFields()};return function(e,t){var a=(0,l.resolveComponent)("el-option"),r=(0,l.resolveComponent)("el-select"),o=(0,l.resolveComponent)("el-form-item"),n=(0,l.resolveComponent)("el-checkbox"),i=(0,l.resolveComponent)("el-checkbox-group"),g=(0,l.resolveComponent)("el-button"),f=(0,l.resolveComponent)("el-form");return(0,l.openBlock)(),(0,l.createBlock)(f,{ref_key:"ruleFormRef",ref:d,model:m,rules:p,"label-width":"120px",class:"demo-ruleForm",size:c.value,"status-icon":""},{default:(0,l.withCtx)((function(){return[(0,l.createVNode)(o,{label:"决策点",prop:"descision"},{default:(0,l.withCtx)((function(){return[(0,l.createVNode)(r,{modelValue:m.descisionId,"onUpdate:modelValue":t[0]||(t[0]=function(e){return m.descisionId=e}),placeholder:"请选择决策点",onChange:s},{default:(0,l.withCtx)((function(){return[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(u),(function(e){return(0,l.openBlock)(),(0,l.createBlock)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),(0,l.createVNode)(o,{label:"决策方式",prop:"type"},{default:(0,l.withCtx)((function(){return[(0,l.createVNode)(i,{modelValue:m.type,"onUpdate:modelValue":t[1]||(t[1]=function(e){return m.type=e})},{default:(0,l.withCtx)((function(){return[(0,l.createVNode)(n,{label:"正确",name:"type"}),(0,l.createVNode)(n,{label:"错误",name:"type"})]})),_:1},8,["modelValue"])]})),_:1}),(0,l.createVNode)(o,null,{default:(0,l.withCtx)((function(){return[(0,l.createVNode)(g,{type:"primary",onClick:t[2]||(t[2]=function(e){return h(d.value)})},{default:(0,l.withCtx)((function(){return[(0,l.createTextVNode)(" Create ")]})),_:1}),(0,l.createVNode)(g,{onClick:t[3]||(t[3]=function(e){return v(d.value)})},{default:(0,l.withCtx)((function(){return[(0,l.createTextVNode)("Reset")]})),_:1})]})),_:1})]})),_:1},8,["model","rules","size"])}}});const u=s;var c=u,d=(0,l.defineComponent)({__name:"attrDescisionGroup",emits:["syncData"],setup:function(e,t){var a=this,o=t.emit,s=function(e){console.log(e);var t=(0,i.find)(u,(function(t){return t.id===e}));m.descision=t.name},u=JSON.parse(localStorage.getItem("descisionGroupList")||"[]");(0,l.onMounted)((function(){n(o,m)}));var c=(0,l.ref)("default"),d=(0,l.ref)(),m=(0,l.reactive)({name:"Hello",descisionId:"",descision:"",count:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""}),p=(0,l.reactive)({name:[{required:!0,message:"Please input Activity name",trigger:"blur"},{min:3,max:5,message:"Length should be 3 to 5",trigger:"blur"}],descisionId:[{required:!0,message:"Please select Activity zone",trigger:"change"}],count:[{required:!0,message:"Please select Activity count",trigger:"change"}],date1:[{type:"date",required:!0,message:"Please pick a date",trigger:"change"}],date2:[{type:"date",required:!0,message:"Please pick a time",trigger:"change"}],type:[{type:"array",required:!0,message:"Please select at least one activity type",trigger:"change"}],resource:[{required:!0,message:"Please select activity resource",trigger:"change"}],desc:[{required:!0,message:"Please input activity form",trigger:"blur"}]}),h=function(e){return(0,r.mG)(a,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return e?[4,e.validate((function(e,t){e?console.log("submit!"):console.log("error submit!",t)}))]:[2];case 1:return t.sent(),[2]}}))}))},v=function(e){e&&e.resetFields()};return function(e,t){var a=(0,l.resolveComponent)("el-option"),r=(0,l.resolveComponent)("el-select"),o=(0,l.resolveComponent)("el-form-item"),n=(0,l.resolveComponent)("el-button"),i=(0,l.resolveComponent)("el-form");return(0,l.openBlock)(),(0,l.createBlock)(i,{ref_key:"ruleFormRef",ref:d,model:m,rules:p,"label-width":"120px",class:"demo-ruleForm",size:c.value,"status-icon":""},{default:(0,l.withCtx)((function(){return[(0,l.createVNode)(o,{label:"决策组",prop:"descision"},{default:(0,l.withCtx)((function(){return[(0,l.createVNode)(r,{modelValue:m.descisionId,"onUpdate:modelValue":t[0]||(t[0]=function(e){return m.descisionId=e}),placeholder:"请选择决策组",onChange:s},{default:(0,l.withCtx)((function(){return[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(u),(function(e){return(0,l.openBlock)(),(0,l.createBlock)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),(0,l.createVNode)(o,null,{default:(0,l.withCtx)((function(){return[(0,l.createVNode)(n,{type:"primary",onClick:t[1]||(t[1]=function(e){return h(d.value)})},{default:(0,l.withCtx)((function(){return[(0,l.createTextVNode)(" Create ")]})),_:1}),(0,l.createVNode)(n,{onClick:t[2]||(t[2]=function(e){return v(d.value)})},{default:(0,l.withCtx)((function(){return[(0,l.createTextVNode)("Reset")]})),_:1})]})),_:1})]})),_:1},8,["model","rules","size"])}}});const m=d;var p,h=m,v=(p={},p[o.lG]=c,p[o.AN]=h,p);const g={class:"command-param"},f={class:"command-left"},y={class:"command-right"},k=(0,l.createElementVNode)("span",null,"无",-1),V={key:2,class:"diff-param"},C={class:"command-param"},F={class:"command-left"},S={key:0,class:"command-right"},b={class:"input-style"},N={key:1,class:"device-unit"},w={class:"device-unit"};function x(e,t,a,r,o,n){const i=(0,l.resolveComponent)("el-option"),s=(0,l.resolveComponent)("el-select"),u=(0,l.resolveComponent)("el-form-item"),c=(0,l.resolveComponent)("el-input"),d=(0,l.resolveComponent)("el-checkbox"),m=(0,l.resolveComponent)("el-form");return(0,l.openBlock)(),(0,l.createBlock)(m,{ref:"diffForm",class:"device-condition common-form",model:o.ruleForm,rules:o.rules,"label-width":"120px","label-position":"top"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(u,{label:"设备产品类型",prop:"componentId"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.componentId,"onUpdate:modelValue":t[0]||(t[0]=e=>o.ruleForm.componentId=e),filterable:"",placeholder:"请选择设备产品类型","popper-class":"selectCustomAttrs"},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.deviceProductTypeList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.id,label:e.prodtypeName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.createVNode)(u,{label:"设备命令",prop:"deviceCommand"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.deviceCommand,"onUpdate:modelValue":t[1]||(t[1]=e=>o.ruleForm.deviceCommand=e),filterable:"",placeholder:"请选择设备命令","popper-class":"selectCustomAttrs",onChange:n.handleDeviceCommandList},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.deviceCommandList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.id,label:e.description,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),o.ruleForm.deviceSkillObject.length>0&&(o.ruleForm.isDeviceSkill||o.ruleForm.noMessage)?((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:0},(0,l.renderList)(o.ruleForm.deviceSkillObject,((e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:e.id,class:"diff-param"},[(0,l.createVNode)(u,{label:"事件属性",class:"deviceParam"},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("span",null,(0,l.toDisplayString)(e.description)+" "+(0,l.toDisplayString)(e.propName),1)])),_:2},1024),(0,l.createVNode)(u,{label:"命令参数",class:"my-select-input deviceParam"},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",g,[(0,l.createElementVNode)("div",f,[(0,l.createVNode)(s,{modelValue:e.operationSign,"onUpdate:modelValue":t=>e.operationSign=t,"popper-class":"selectCustomAttrs",onChange:e=>n.handleDeviceParamSelect(e,t)},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.operationSignList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.key,label:e.value,value:e.key},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),(0,l.createElementVNode)("div",y,["enum"===e.propValType||"bool"===e.propValType||"int"===e.propValType&&"1"===e.exchangeType?((0,l.openBlock)(),(0,l.createBlock)(u,{key:0,prop:"deviceSkillObject."+t+".param",rules:[{required:!0,message:"参数值不能为空",trigger:"change"}]},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:e.param,"onUpdate:modelValue":t=>e.param=t,style:{width:"100%"},placeholder:"请选择参数","popper-class":"selectCustomAttrs",onChange:e=>n.handleSkillSelect(e,t,"select")},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.variantsList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.stdValue,label:e.description,value:e.stdValue},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:2},1032,["prop"])):((0,l.openBlock)(),(0,l.createBlock)(u,{key:1,prop:"deviceSkillObject."+t+".param",class:"my-select-input deviceParam",rules:[{required:!0,message:"参数值不能为空",trigger:"blur"},{validator:(t,a,r)=>{n.getVariantsValue(e,a,r)}}]},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{modelValue:e.param,"onUpdate:modelValue":t=>e.param=t,style:{width:"100%"},maxlength:"string"===e.propValType?500:null,placeholder:e.variantsList?""+("请输入"+e.variantsList.minValue+"到"+e.variantsList.maxValue+",步长:"+e.variantsList.step):"请输入字符串值",onChange:e=>n.handleSkillSelect(e,t,"input")},null,8,["modelValue","onUpdate:modelValue","maxlength","placeholder","onChange"])])),_:2},1032,["prop","rules"]))])])])),_:2},1024),(0,l.createVNode)(u,{label:"用户编辑",prop:"deviceSkillObject."+t+".require",class:"checkbox-style"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(d,{modelValue:e.require,"onUpdate:modelValue":t=>e.require=t,onChange:e=>n.handleSkillSelect(e,t,"check")},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("支持")])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:2},1032,["prop"])])))),128)):0===o.ruleForm.deviceSkillObject.length&&o.ruleForm.isDeviceSkill?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createVNode)(u,{label:"命令参数",prop:"commandParam"},{default:(0,l.withCtx)((()=>[k])),_:1}),(0,l.createVNode)(u,{label:"用户编辑",class:"checkbox-style"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(d,{disabled:!0},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("支持")])),_:1})])),_:1})],64)):((0,l.openBlock)(),(0,l.createElementBlock)("div",V,[o.ruleForm.noMessage?(0,l.createCommentVNode)("",!0):((0,l.openBlock)(),(0,l.createBlock)(u,{key:0,label:"命令参数",class:"my-select-input deviceParam"},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",C,[(0,l.createElementVNode)("div",F,[(0,l.createVNode)(s,{modelValue:o.ruleForm.operationSign,"onUpdate:modelValue":t[2]||(t[2]=e=>o.ruleForm.operationSign=e),disabled:o.ruleForm.noAlarm,"popper-class":"selectCustomAttrs",class:(0,l.normalizeClass)(o.ruleForm.noAlarm?"setMaxWidth":"")},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.ruleForm.operationSignList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.key,label:e.value,value:e.key},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled","class"])]),o.ruleForm.noAlarm?(0,l.createCommentVNode)("",!0):((0,l.openBlock)(),(0,l.createElementBlock)("div",S,[Array.isArray(o.ruleForm.variantsList)||""===o.ruleForm.deviceCommand?((0,l.openBlock)(),(0,l.createBlock)(u,{key:0,prop:"commandParamSelect"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.commandParamSelect,"onUpdate:modelValue":t[3]||(t[3]=e=>o.ruleForm.commandParamSelect=e),style:{width:"100%"},placeholder:"请选择参数","popper-class":"selectCustomAttrs",onChange:n.handleChangeCommad},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.ruleForm.variantsList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.stdValue,label:e.description,value:e.stdValue},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):((0,l.openBlock)(),(0,l.createBlock)(u,{key:1,prop:"inputValue"},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",b,[(0,l.createVNode)(c,{modelValue:o.ruleForm.inputValue,"onUpdate:modelValue":t[4]||(t[4]=e=>o.ruleForm.inputValue=e),type:"text",maxlength:o.ruleForm.variantsList&&o.ruleForm.variantsList.propValType&&"string"==o.ruleForm.variantsList.propValType?500:null,class:(0,l.normalizeClass)(o.ruleForm.variantsList&&o.ruleForm.variantsList.propValType&&"string"==o.ruleForm.variantsList.propValType?"string-width":""),placeholder:o.inputPlaceHolder,onBlur:n.handleChangeInput},null,8,["modelValue","maxlength","class","placeholder","onBlur"])])])),_:1}))])),!Array.isArray(o.ruleForm.variantsList)&&o.ruleForm.variantsList&&o.ruleForm.variantsList.unit&&!o.ruleForm.noAlarm?((0,l.openBlock)(),(0,l.createElementBlock)("div",N,[(0,l.createElementVNode)("span",w,(0,l.toDisplayString)(o.ruleForm.variantsList.unit),1)])):(0,l.createCommentVNode)("",!0)])])),_:1})),(0,l.createVNode)(u,{label:"用户编辑",class:"checkbox-style"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(d,{modelValue:o.ruleForm.isRequired,"onUpdate:modelValue":t[5]||(t[5]=e=>o.ruleForm.isRequired=e),disabled:o.ruleForm.noAlarm,onChange:n.handleUuterSupport},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("支持")])),_:1},8,["modelValue","disabled","onChange"])])),_:1})])),(0,l.createVNode)(u,{label:"条件描述",style:{width:"100%"}},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{modelValue:o.ruleForm.desc,"onUpdate:modelValue":t[6]||(t[6]=e=>o.ruleForm.desc=e),maxlength:"100",type:"textarea",class:(0,l.normalizeClass)({"input-focus":o.inputFocus}),"show-word-limit":"",placeholder:"请填写条件描述，最多100字符",onFocus:t[7]||(t[7]=e=>o.inputFocus=!0),onBlur:t[8]||(t[8]=e=>o.inputFocus=!1)},null,8,["modelValue","class"])])),_:1})])),_:1},8,["model","rules"])}var B=a(1868),D={props:{fragmentListData:{type:Object,default(){return{}}},singData:{type:Object,default(){return{}}}},data(){return{inputFocus:!1,ruleForm:{componentId:"",deviceCommand:"",stdDesc:"",isRequired:!1,noMessage:!1,noAlarm:!1,desc:"",operationSign:"equal",operationSignList:[{key:"equal",value:"等于"}],deviceSkillObject:[],key:{desc:"",value:"",id:""},value:{value:"",desc:"",required:!1},params:[],variantsParamList:null,isDeviceSkill:!1,variantsList:null,inputValue:"",commandParamSelect:""},source:this.$route.query.source||"",rules:{componentId:[{required:!0,message:"请选择设备产品类型",trigger:"change"}],deviceCommand:[{required:!0,message:"请选择设备命令",trigger:"change"}],commandParamSelect:[{required:!0,message:"请选择命令参数",trigger:"blur"}],inputValue:[{required:!0,message:"请输入命令参数",trigger:"blur"},{validator:(e,t,a)=>{const r={variantsList:this.ruleForm.variantsList,propValType:this.ruleForm.variantsList.propValType};this.getVariantsValue(r,t,a)},trigger:"blur"}]},deviceProductTypeList:[],deviceCommandList:[],inputPlaceHolder:"",editData:this.singData}},watch:{"ruleForm.componentId":{handler(e,t){if(console.log(e,"val---"),e){t&&e!==t&&(this.editData={});const a=this.deviceProductTypeList.filter((t=>t.id===e));this.ruleForm.stdDesc=a[0].prodtypeName,this.ruleForm.prodtypeName=a[0].prodtypeName,this.ruleForm.prodtypeCode=a[0].prodtypeCode,this.handleDeviceCommand()}},immediate:!0,deep:!0}},mounted(){this.handleDeviceProductType(),n(this.$emit,this.ruleForm)},methods:{handleUuterSupport(e){this.ruleForm.value.required=e},handleDeviceParamSelect(e,t){this.ruleForm.params[t].operationSign=e,this.$forceUpdate()},handleDeviceProductType(){let e;e="southeastAsia"===this.source?"/developerportal/dny/developer/prodtype/getAllProdtypeList":"/developerportal/developer/prodtype/getAllProdtypeList",(0,B.U)("post",e).then((e=>{if("00000"===e.retCode)return this.deviceProductTypeList=e.data,!0})).then((()=>{"{}"!==JSON.stringify(this.editData)&&(this.ruleForm.componentId=this.editData.componentId)}))},handleDeviceCommand(){let e;e="southeastAsia"===this.source?"/developerportal/dny/developer/prodtypeFunction/getProdtypeConditionFunctionList":"/developerportal/developer/prodtypeFunction/getProdtypeConditionFunctionList",(0,B.U)("post",e,{prodtypeId:this.ruleForm.componentId}).then((e=>{if("00000"===e.retCode)return e.data.map((e=>{console.log(e.type),"skill"==e.type&&(e.description="(语音)"+e.description),"deviceSkill"==e.type&&(e.description="(技)"+e.description)})),this.deviceCommandList=e.data,this.$nextTick((()=>{this.$refs.diffForm.clearValidate("deviceCommand"),this.ruleForm.isDeviceSkill=!1,this.ruleForm.noMessage=!1,this.ruleForm.deviceSkillObject=[],this.ruleForm.params=[],this.ruleForm.variantsParamList=null,this.ruleForm.variantsList=null,this.ruleForm.inputValue="",this.ruleForm.commandParamSelect="",this.ruleForm.operationSignList=[{key:"equal",value:"等于"}]})),this.ruleForm.deviceCommand="",!0})).then((()=>{"{}"!==JSON.stringify(this.editData)&&(this.ruleForm.deviceCommand=this.editData.key.id,this.handleDeviceCommandList(this.ruleForm.deviceCommand))}))},handleDeviceCommandList(e){console.log("选中的值",e),this.$refs.diffForm.clearValidate(),"{}"!==JSON.stringify(this.editData)&&e!==this.editData.key.id&&(this.editData={}),this.ruleForm.deviceSkillObject=[],this.ruleForm.isDeviceSkill=!1,this.ruleForm.operationSign="equal",this.ruleForm.operationSignList=[{key:"equal",value:"等于"}],this.ruleForm.variantsParamList=null,this.ruleForm.variantsList=null,this.ruleForm.inputValue="",this.ruleForm.commandParamSelect="",this.ruleForm.isRequired=!1,this.ruleForm.params=[];const t=this.deviceCommandList.filter((t=>t.id===e));if("property"===t[0].type)if(this.ruleForm.isDeviceSkill=!1,this.ruleForm.params=[],this.noAlarm=!1,this.noMessage=!1,this.ruleForm.key={desc:t[0].description,value:t[0].name,id:t[0].id},"{}"!==JSON.stringify(this.editData)&&this.$set(this.ruleForm,"desc",this.editData.desc),"int"==t[0].valType){const e=JSON.parse(t[0].variants);this.inputPlaceHolder="请输入"+e.minValue+"到"+e.maxValue+",步长:"+e.step,this.ruleForm.variantsList=e,this.ruleForm.variantsList.propValType=t[0].valType,this.ruleForm.operationSignList=[{key:"greaterThan",value:"高于"},{key:"equal",value:"等于"},{key:"lessThan",value:"低于"}],"{}"!==JSON.stringify(this.editData)&&(this.$set(this.ruleForm,"inputValue",this.editData.value.value),this.$set(this.ruleForm,"value",this.editData.value),this.$set(this.ruleForm,"operationSign",this.editData.operationSign),this.$set(this.ruleForm,"isRequired",this.editData.value.required))}else if("bool"==t[0].valType||"enum"==t[0].valType){const e=JSON.parse(t[0].variants);e.map((e=>{"string"!==typeof e.stdValue&&(e.stdValue=e.stdValue.toString())})),this.ruleForm.variantsList=e,"bool"==t[0].valType&&(this.ruleForm.operationSignList=[{key:"equal",value:"等于"}]),"enum"==t[0].valType&&(this.ruleForm.operationSignList=[{key:"equal",value:"等于"},{key:"unequal",value:"不等于"}]),"{}"!==JSON.stringify(this.editData)&&(this.$set(this.ruleForm,"commandParamSelect",this.editData.value.value),this.$set(this.ruleForm,"value",this.editData.value),this.$set(this.ruleForm,"operationSign",this.editData.operationSign),this.$set(this.ruleForm,"isRequired",this.editData.value.required))}else if("double"==t[0].valType){const e=JSON.parse(t[0].variants);this.ruleForm.operationSignList=[{key:"greaterThan",value:"高于"},{key:"equal",value:"等于"},{key:"lessThan",value:"低于"}],this.inputPlaceHolder="请输入"+e.minValue+"到"+e.maxValue+",步长:"+e.step,this.ruleForm.variantsList=e,this.ruleForm.variantsList.propValType=t[0].valType,"{}"!==JSON.stringify(this.editData)&&(this.$set(this.ruleForm,"inputValue",this.editData.value.value),this.$set(this.ruleForm,"operationSign",this.editData.operationSign),this.$set(this.ruleForm,"value",this.editData.value),this.$set(this.ruleForm,"isRequired",this.editData.value.required))}else"string"==t[0].valType&&(void 0===t[0].variants?this.ruleForm.variantsList={}:this.ruleForm.variantsList=JSON.parse(t[0].variants),this.ruleForm.operationSignList=[{key:"greaterThan",value:"高于"},{key:"equal",value:"等于"},{key:"lessThan",value:"低于"},{key:"greaterThanEqual",value:"高于或等于"},{key:"unequal",value:"不等于"},{key:"lessThanEqual",value:"低于或等于"}],this.inputPlaceHolder="",this.ruleForm.variantsList.propValType="string","{}"!==JSON.stringify(this.editData)&&(this.$set(this.ruleForm,"inputValue",this.editData.value.value),this.$set(this.ruleForm,"value",this.editData.value),this.$set(this.ruleForm,"operationSign",this.editData.operationSign),this.$set(this.ruleForm,"isRequired",this.editData.value.required)));"deviceSkill"===t[0].type?(this.ruleForm.key={desc:t[0].stdDescription,value:t[0].name,id:t[0].id,type:"deviceSkill"},"{}"!==JSON.stringify(this.editData)&&(this.$set(this.ruleForm,"desc",this.editData.desc),this.$set(this.ruleForm,"params",this.editData.params)),this.ruleForm.isDeviceSkill=!0,this.ruleForm.deviceSkillObject=t[0].prodtypeFunctionSubDtoList?t[0].prodtypeFunctionSubDtoList:[],this.ruleForm.deviceSkillObject.length>0?this.ruleForm.deviceSkillObject.map(((e,t)=>{this.$set(e,"param","");const a={desc:e.description,key:{desc:e.description,id:e.id,type:"deviceSkill",value:e.propName},logicalSign:"AND",operationSign:"equal",value:{desc:"",required:!1,value:""}};if("{}"===JSON.stringify(this.editData)&&this.ruleForm.params.push(a),"enum"==e.propValType){if(e.variants){const t=this.isJSON_test(e.variants)?JSON.parse(e.variants):[];t.map((e=>{"string"!==typeof e.stdValue&&(e.stdValue=e.stdValue+"")})),e.variantsList=t}e.placeholder="请选择参数",e.operationSignList=[{key:"equal",value:"等于"},{key:"unequal",value:"不等于"}],"{}"!==JSON.stringify(this.editData)?(this.$set(e,"param",this.editData.params[t].value.value),this.$set(e,"operationSign",this.editData.params[t].operationSign),this.$set(e,"require",this.editData.params[t].value.required),this.$set(e,"value",this.editData.value),this.$set(e,"params",this.editData.params)):(e.operationSign="equal",e.require=!1)}else if("string"==e.propValType)e.variants?(e.variantsList=this.isJSON_test(e.variants)?JSON.parse(e.variants):"",e.placeholder="请输入"+e.variantsList.minValue+"到"+e.variantsList.maxValue+",步长:"+e.variantsList.step,e.unit=e.variantsList.unit?e.variantsList.unit:""):e.placeholder="请输入字符串",e.operationSignList=[{key:"greaterThan",value:"高于"},{key:"equal",value:"等于"},{key:"lessThan",value:"低于"},{key:"greaterThanEqual",value:"高于或等于"},{key:"unequal",value:"不等于"},{key:"lessThanEqual",value:"低于或等于"}],"{}"!==JSON.stringify(this.editData)?(this.$set(e,"param",this.editData.params[t].value.value),this.$set(e,"operationSign",this.editData.params[t].operationSign),this.$set(e,"require",this.editData.params[t].value.required),this.$set(e,"value",this.editData.value),this.$set(e,"params",this.editData.params)):(e.operationSign="equal",e.require=!1);else if("bool"==e.propValType){if(e.variants){const t=this.isJSON_test(e.variants)?JSON.parse(e.variants):[];t.map((e=>{"string"!==typeof e.stdValue&&(e.stdValue=e.stdValue+"")})),e.variantsList=t}e.placeholder="请选择参数",e.operationSignList=[{key:"equal",value:"等于"}],"{}"!==JSON.stringify(this.editData)?(this.$set(e,"param",this.editData.params[t].value.value),this.$set(e,"operationSign",this.editData.params[t].operationSign),this.$set(e,"require",this.editData.params[t].value.required),this.$set(e,"value",this.editData.value),this.$set(e,"params",this.editData.params)):(e.operationSign="equal",e.require=!1)}else e.propValType,e.variants?(e.variantsList=this.isJSON_test(e.variants)?JSON.parse(e.variants):"",e.placeholder="请输入"+e.variantsList.minValue+"到"+e.variantsList.maxValue+",步长:"+e.variantsList.step,e.unit=e.variantsList.unit?e.variantsList.unit:""):e.placeholder="请输入",e.operationSignList=[{key:"greaterThan",value:"高于"},{key:"equal",value:"等于"},{key:"lessThan",value:"低于"}],"{}"!==JSON.stringify(this.editData)?(this.$set(e,"param",Number(this.editData.params[t].value.value)),this.$set(e,"operationSign",this.editData.params[t].operationSign),this.$set(e,"require",this.editData.params[t].value.required),this.$set(e,"value",this.editData.value),this.$set(e,"params",this.editData.params)):(e.operationSign="equal",e.require=!1)})):this.ruleForm.params=[]):this.ruleForm.isDeviceSkill=!1,"message"==t[0].type?(this.ruleForm.noMessage=!0,this.ruleForm.key={desc:t[0].stdDescription,value:t[0].name,id:t[0].id,type:"message"},"{}"!==JSON.stringify(this.editData)&&(this.$set(this.ruleForm,"desc",this.editData.desc),this.$set(this.ruleForm,"params",this.editData.params)),this.ruleForm.deviceSkillObject=t[0].prodtypeFunctionSubDtoList?t[0].prodtypeFunctionSubDtoList:[],this.ruleForm.deviceSkillObject.length>0?this.ruleForm.deviceSkillObject.map(((e,t)=>{this.$set(e,"param","");const a={desc:e.description,key:{desc:e.description,id:e.id,type:"message",value:e.propName},logicalSign:"AND",operationSign:"equal",value:{desc:"",required:!1,value:""}};if("{}"===JSON.stringify(this.editData)&&this.ruleForm.params.push(a),"enum"==e.propValType){if(e.variants){const t=this.isJSON_test(e.variants)?JSON.parse(e.variants):[];t.map((e=>{"string"!==typeof e.stdValue&&(e.stdValue=e.stdValue+"")})),e.variantsList=t}e.placeholder="请选择参数",e.operationSignList=[{key:"equal",value:"等于"},{key:"unequal",value:"不等于"}],"{}"!==JSON.stringify(this.editData)?(this.$set(e,"param",this.editData.params[t].value.value),this.$set(e,"operationSign",this.editData.params[t].operationSign),this.$set(e,"require",this.editData.params[t].value.required),this.$set(e,"value",this.editData.value),this.$set(e,"params",this.editData.params)):(e.operationSign="equal",e.require=!1)}else if("string"==e.propValType)e.variants?(e.variantsList=this.isJSON_test(e.variants)?JSON.parse(e.variants):"",e.placeholder="请输入"+e.variantsList.minValue+"到"+e.variantsList.maxValue+",步长:"+e.variantsList.step,e.unit=e.variantsList.unit?e.variantsList.unit:""):e.placeholder="请输入字符串",e.operationSignList=[{key:"greaterThan",value:"高于"},{key:"equal",value:"等于"},{key:"lessThan",value:"低于"},{key:"greaterThanEqual",value:"高于或等于"},{key:"unequal",value:"不等于"},{key:"lessThanEqual",value:"低于或等于"}],"{}"!==JSON.stringify(this.editData)?(this.$set(e,"param",this.editData.params[t].value.value),this.$set(e,"operationSign",this.editData.params[t].operationSign),this.$set(e,"require",this.editData.params[t].value.required),this.$set(e,"value",this.editData.value),this.$set(e,"params",this.editData.params)):(e.operationSign="equal",e.require=!1);else if("bool"==e.propValType){if(e.variants){const t=this.isJSON_test(e.variants)?JSON.parse(e.variants):[];t.map((e=>{"string"!==typeof e.stdValue&&(e.stdValue=e.stdValue+"")})),e.variantsList=t}e.placeholder="请选择参数",e.operationSignList=[{key:"equal",value:"等于"}],"{}"!==JSON.stringify(this.editData)?(this.$set(e,"param",this.editData.params[t].value.value),this.$set(e,"operationSign",this.editData.params[t].operationSign),this.$set(e,"require",this.editData.params[t].value.required),this.$set(e,"value",this.editData.value),this.$set(e,"params",this.editData.params)):(e.operationSign="equal",e.require=!1)}else if("int"==e.propValType)if("1"===e.exchangeType){if(e.exchangeVariants){const t=this.isJSON_test(e.exchangeVariants)?JSON.parse(e.exchangeVariants):[];t.map((e=>{"string"!==typeof e.stdValue&&(e.stdValue=e.stdValue+"")})),e.variantsList=t}e.placeholder="请选择参数",e.operationSignList=[{key:"equal",value:"等于"},{key:"unequal",value:"不等于"}],"{}"!==JSON.stringify(this.editData)?(this.$set(e,"param",this.editData.params[t].value.value),this.$set(e,"operationSign",this.editData.params[t].operationSign),this.$set(e,"require",this.editData.params[t].value.required),this.$set(e,"value",this.editData.value),this.$set(e,"params",this.editData.params)):(e.operationSign="equal",e.require=!1)}else e.variants?(e.variantsList=this.isJSON_test(e.variants)?JSON.parse(e.variants):"",e.placeholder="请输入"+e.variantsList.minValue+"到"+e.variantsList.maxValue+",步长:"+e.variantsList.step,e.unit=e.variantsList.unit?e.variantsList.unit:""):e.placeholder="请输入",e.operationSignList=[{key:"greaterThan",value:"高于"},{key:"equal",value:"等于"},{key:"lessThan",value:"低于"}],"{}"!==JSON.stringify(this.editData)?(this.$set(e,"param",Number(this.editData.params[t].value.value)),this.$set(e,"operationSign",this.editData.params[t].operationSign),this.$set(e,"require",this.editData.params[t].value.required),this.$set(e,"value",this.editData.value),this.$set(e,"params",this.editData.params)):(e.operationSign="equal",e.require=!1);else e.variants?(e.variantsList=this.isJSON_test(e.variants)?JSON.parse(e.variants):"",e.placeholder="请输入"+e.variantsList.minValue+"到"+e.variantsList.maxValue+",步长:"+e.variantsList.step,e.unit=e.variantsList.unit?e.variantsList.unit:""):e.placeholder="请输入",e.operationSignList=[{key:"greaterThan",value:"高于"},{key:"equal",value:"等于"},{key:"lessThan",value:"低于"}],"{}"!==JSON.stringify(this.editData)?(this.$set(e,"param",Number(this.editData.params[t].value.value)),this.$set(e,"operationSign",this.editData.params[t].operationSign),this.$set(e,"require",this.editData.params[t].value.required),this.$set(e,"value",this.editData.value),this.$set(e,"params",this.editData.params)):(e.operationSign="equal",e.require=!1)})):this.ruleForm.params=[]):this.ruleForm.noMessage=!1,"alarm"==t[0].type?(this.ruleForm.noAlarm=!0,this.ruleForm.params=[],this.ruleForm.key={desc:t[0].description,value:t[0].name,id:t[0].id},this.ruleForm.value={desc:"",required:!1,value:""},"{}"!==JSON.stringify(this.editData)&&this.$set(this.ruleForm,"desc",this.editData.desc)):this.ruleForm.noAlarm=!1},isJSON_test(e){if("string"==typeof e)try{var t=JSON.parse(e);return console.log(t),!0}catch(a){return!1}},getVariantsValue(e,t,a){if(e.variantsList&&t){if("double"===e.propValType&&(this.$vertifyMethods.isDouble(t,2)||a("数据不符合要求"),parseFloat(t)<parseFloat(e.variantsList.minValue)||parseFloat(t)>parseFloat(e.variantsList.maxValue)||parseFloat(t)%parseFloat(e.variantsList.step)!==0?a("参数值数据格式不合法，请重新填写"):a()),"int"===e.propValType){let r=/^[0-9]*$/;r.test(t)||a("数据不符合要求"),console.log(Number(t),Number(e.variantsList.minValue)),Number(t)<Number(e.variantsList.minValue)||Number(t)>Number(e.variantsList.maxValue)||Number(t)%Number(e.variantsList.step)!==0?a("参数值数据格式不合法，请重新填写"):a()}"string"===e.propValType&&a()}else a()},handleSkillSelect(e,t,a){"select"===a?this.ruleForm.deviceSkillObject[t].variantsList.filter((a=>{a.stdValue===e&&(this.ruleForm.params[t].value={desc:a.description,required:this.ruleForm.deviceSkillObject[t].require,value:e})})):"input"===a?this.ruleForm.params[t].value={desc:e,required:this.ruleForm.deviceSkillObject[t].require,value:e}:(this.$set(this.ruleForm.deviceSkillObject[t],"require",e),this.ruleForm.params[t].value.required=e,this.$forceUpdate())},resetFormData(){this.$refs.diffForm.resetFields()},handleChangeCommad(e){e&&this.$refs.diffForm.clearValidate("commandParamSelect");const t=this.ruleForm.variantsList.filter((t=>t.stdValue===e));this.ruleForm.value={desc:t[0].description,value:e,required:this.ruleForm.isRequired}},handleChangeSelectParamSet(e){const t=this.ruleForm.variantsParamList.filter((t=>t.stdValue===e));this.ruleForm.args[0].value={desc:t[0].description,value:e,required:this.ruleForm.isRequired}},handleChangeParamSet(e){let t;this.ruleForm.variantsList.unit&&(t=e.target.value+this.ruleForm.variantsList.unit),this.ruleForm.args[0].value={desc:t,value:e.target.value,required:this.ruleForm.isRequired}},handleChangeInput(e){let t;t=this.ruleForm.variantsList.unit?e.target.value+this.ruleForm.variantsList.unit:e.target.value,this.ruleForm.value={desc:t,value:e.target.value,required:this.ruleForm.isRequired}}}},L=a(3744);const _=(0,L.Z)(D,[["render",x]]);var T=_;const q=(0,l.createElementVNode)("span",{style:{margin:"0 6px"}},"时",-1),E=(0,l.createElementVNode)("span",{style:{"margin-left":"6px"}},"分",-1);function P(e,t,a,r,o,n){const i=(0,l.resolveComponent)("el-option"),s=(0,l.resolveComponent)("el-select"),u=(0,l.resolveComponent)("el-form-item"),c=(0,l.resolveComponent)("el-checkbox"),d=(0,l.resolveComponent)("el-checkbox-group"),m=(0,l.resolveComponent)("el-form");return(0,l.openBlock)(),(0,l.createBlock)(m,{ref:"diffForm",model:o.value,class:"common-form","label-width":"100px","label-position":"top"},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",null,[(0,l.createVNode)(u,{label:"时间设置",class:"item-required"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.value.hours,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value.hours=e),style:{width:"122px"},"popper-class":"selectCustomAttrs",placeholder:""},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.setHour,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),q,(0,l.createVNode)(s,{modelValue:o.value.minutes,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value.minutes=e),style:{width:"122px"},"popper-class":"selectCustomAttrs",placeholder:""},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.setMinutes,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),E])),_:1})]),(0,l.createVNode)(u,{label:"重复设置",class:"item-required"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.value.repeatType,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value.repeatType=e),style:{width:"100%"},"popper-class":"selectCustomAttrs",onChange:n.handleRepeatSet},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.repeatTypeMap,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.id,label:e.description,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,l.createVNode)(u,null,{default:(0,l.withCtx)((()=>[4==o.value.repeatType?((0,l.openBlock)(),(0,l.createBlock)(d,{key:0,modelValue:o.value.repeatTypeArr,"onUpdate:modelValue":t[3]||(t[3]=e=>o.value.repeatTypeArr=e),onChange:n.changeBox},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.customSetList,(e=>((0,l.openBlock)(),(0,l.createBlock)(c,{key:e.id,label:e.id},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.description),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","onChange"])):(0,l.createCommentVNode)("",!0)])),_:1})])),_:1},8,["model"])}var O=function(e,t){"undefined"===typeof t&&(t=!1);for(var a=new Array(e),r=0;r<e;r++)a[r]=t&&r<10?"0"+r.toString():r.toString();return a},I={initHMS:O},A={props:{singData:{type:Object,default(){return{}}}},data(){return{value:{desc:"",required:!0,value:"",minutes:"00",hours:"00",repeatType:1,repeatTypeArr:[]},ruleForm:{componentId:"",key:{id:"",value:"",desc:""},logicalSign:"OR",operationSign:"equal"},source:this.$route.query.source||"",setHour:null,setMinutes:null,repeatTypeMap:[{description:"每天",id:1},{description:"工作日(周一至周五)",id:2},{description:"休息日(周六至周日)",id:3},{description:"自定义",id:4}],customSetList:[{description:"星期日",id:1},{description:"星期一",id:2},{description:"星期二",id:3},{description:"星期三",id:4},{description:"星期四",id:5,checked:!1},{description:"星期五",id:6,checked:!1},{description:"星期六",id:7,checked:!1}]}},mounted(){if(this.setHour=I.initHMS(24,!0),this.setMinutes=I.initHMS(60,!0),this.getTimer(),"{}"!==JSON.stringify(this.singData)){const e=this.singData.value.value.split("?");this.value.hours=e[0].split(" ")[1],this.value.minutes=e[0].split(" ")[2];const t=e[1].split("*")[1].split(" ")[1];if("1,2,3,4,5,6,7"==t)this.value.repeatType=1;else if("2,3,4,5,6"===t)this.value.repeatType=2;else if("1,7"===t)this.value.repeatType=3;else{this.value.repeatType=4;const t=e[1].split(" ")[2].split(",");t.map((e=>{this.value.repeatTypeArr.push(Number(e))}))}}n(this.$emit,this.value)},methods:{getTimer(){let e;e="southeastAsia"===this.source?"/developerportal/dny/developer/component/cmptPropList/TIMER":"/developerportal/developer/component/cmptPropList/TIMER",(0,B.U)("get",e).then((e=>{"00000"===e.retCode&&(this.ruleForm={componentId:e.data[0].componentId,key:{id:e.data[0].id,value:e.data[0].name,desc:e.data[0].description}})}))},handleRepeatSet(){this.value.repeatTypeArr=[]},resetFormData(){this.value={minutes:"00",hours:"00",repeatType:1,repeatTypeArr:[]}},changeBox(e){console.log(e)}}};const $=(0,L.Z)(A,[["render",P]]);var J=$;const M={class:"typeinput"},U={key:0,class:"unit"};function j(e,t,a,r,o,n){const i=(0,l.resolveComponent)("el-option"),s=(0,l.resolveComponent)("el-select"),u=(0,l.resolveComponent)("el-form-item"),c=(0,l.resolveComponent)("el-input"),d=(0,l.resolveComponent)("el-form");return(0,l.openBlock)(),(0,l.createBlock)(d,{ref:"diffForm",model:o.ruleForm,class:"weather-condition common-form",rules:o.rules,"label-width":"100px","label-position":"top"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(u,{label:"设备命令",prop:"id"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.id,"onUpdate:modelValue":t[0]||(t[0]=e=>o.ruleForm.id=e),style:{width:"100%"},placeholder:"请选择设备命令","popper-class":"selectCustomAttrs",onChange:n.handleDeviceCommand},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.deviceCommandList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.id,label:e.description,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,l.createElementVNode)("div",null,[(0,l.createVNode)(u,{label:"命令参数",class:"deviceParam"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.operationSign,"onUpdate:modelValue":t[1]||(t[1]=e=>o.ruleForm.operationSign=e),style:{width:"80px"},"popper-class":"selectCustomAttrs",disabled:""==o.ruleForm.id},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.operationSignList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.name,label:e.value,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"]),o.selectedWeatherCondition.length>0&&"enum"==o.selectedWeatherCondition[0].valType||""==o.ruleForm.id?((0,l.openBlock)(),(0,l.createBlock)(u,{key:0,prop:"deviceParam",class:"deviceParamSelect"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.deviceParam,"onUpdate:modelValue":t[2]||(t[2]=e=>o.ruleForm.deviceParam=e),style:{"margin-left":"16px",width:"calc(100% - 16px)"},disabled:""==o.ruleForm.id,"popper-class":"selectCustomAttrs",onChange:n.handleChangeCommandParam},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.equalList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.stdValue,label:e.description,value:e.stdValue},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled","onChange"])])),_:1})):(0,l.createCommentVNode)("",!0),o.selectedWeatherCondition.length>0&&"int"==o.selectedWeatherCondition[0].valType?((0,l.openBlock)(),(0,l.createBlock)(u,{key:1,prop:"deviceInputParam",class:"deviceParamSelect"},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",M,[(0,l.createVNode)(c,{modelValue:o.ruleForm.deviceInputParam,"onUpdate:modelValue":t[3]||(t[3]=e=>o.ruleForm.deviceInputParam=e),placeholder:o.dataPlaceHolder,disabled:""==o.ruleForm.id,onBlur:n.handleBlur},null,8,["modelValue","placeholder","disabled","onBlur"]),null!=o.equalList?((0,l.openBlock)(),(0,l.createElementBlock)("span",U,(0,l.toDisplayString)(o.equalList.unit),1)):(0,l.createCommentVNode)("",!0)])])),_:1})):(0,l.createCommentVNode)("",!0)])),_:1})]),(0,l.createVNode)(u,{label:"条件描述",style:{width:"100%"}},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{modelValue:o.ruleForm.desc,"onUpdate:modelValue":t[4]||(t[4]=e=>o.ruleForm.desc=e),type:"textarea",maxlength:"100",rows:2,class:(0,l.normalizeClass)({"input-focus":o.inputFocus}),"show-word-limit":"",placeholder:"请填写条件描述，最多100字符",onFocus:t[5]||(t[5]=e=>o.inputFocus=!0),onBlur:t[6]||(t[6]=e=>o.inputFocus=!1)},null,8,["modelValue","class"])])),_:1})])),_:1},8,["model","rules"])}var H={props:{singData:{type:Object,default(){return{}}}},data(){return{inputFocus:!1,ruleForm:{componentId:"",id:"",deviceParam:"",deviceInputParam:"",operationSign:"equal",desc:"",key:{desc:"",id:"",value:""},value:{desc:"",required:!0,value:""}},rules:{id:[{required:!0,message:"请选择设备命令",trigger:"change"}],deviceParam:[{required:!0,message:"命令参数数据格式不合法，请重新填写",trigger:"change"}],deviceInputParam:[{required:!0,validator:(e,t,a)=>{t?t<this.equalList.minValue||t>this.equalList.maxValue||t%this.equalList.step!==0?a(new Error("命令参数数据格式不合法，请重新填写")):a():a(new Error("数据不符合要求"))},trigger:"blur"}]},source:this.$route.query.source||"",deviceCommandList:[],selectedWeatherCondition:[],equalList:null,operationSignList:[{name:"equal",value:"等于"}],dataPlaceHolder:""}},watch:{"ruleForm.id":{handler(e){if(e){const t=this.deviceCommandList.filter((t=>t.id==e));this.ruleForm.key={desc:t[0].description,id:t[0].id,value:t[0].name},this.ruleForm.componentId=t[0].componentId,"enum"==t[0].valType&&(this.equalList=JSON.parse(t[0].variants),t[0].isLegal=!0,this.operationSignList=[{name:"equal",value:"等于"}],t[0].operationSign="equal",this.dataPlaceHolder=""),"int"==t[0].valType&&(this.equalList=JSON.parse(t[0].variants),t[0].isLegal=!0,this.operationSignList=[{name:"greaterThan",value:"高于"},{name:"lessThan",value:"低于"}],this.dataPlaceHolder="请输入"+this.equalList.minValue+"到"+this.equalList.maxValue+",步长为"+this.equalList.step),this.selectedWeatherCondition=t,this.ruleForm.operationSign=this.operationSignList[0].name}}}},mounted(){this.$refs.diffForm.clearValidate(),this.getDeivceCommand(),n(this.$emit,this.ruleForm)},methods:{getDeivceCommand(){let e;e="southeastAsia"===this.source?"/developerportal/dny/developer/component/cmptPropList/WEATHER":"/developerportal/developer/component/cmptPropList/WEATHER",(0,B.U)("get",e).then((e=>{"00000"===e.retCode&&(this.deviceCommandList=e.data)})).then((()=>{if("{}"!==JSON.stringify(this.singData)){this.ruleForm={...this.singData},this.ruleForm.id=this.singData.key.id;const e=this.deviceCommandList.filter((e=>e.id==this.ruleForm.id));"enum"==e[0].valType&&"{}"!==JSON.stringify(this.singData)&&this.$set(this.ruleForm,"deviceParam",this.singData.value.value),"int"==e[0].valType&&"{}"!==JSON.stringify(this.singData)&&this.$set(this.ruleForm,"deviceInputParam",this.singData.value.value)}}))},handleDeviceCommand(){this.$refs.diffForm.clearValidate("deviceParam"),this.$refs.diffForm.clearValidate("deviceInputParam"),this.ruleForm.deviceInputParam="",this.ruleForm.deviceParam=""},handleBlur(e){this.ruleForm.value={desc:e.target.value+this.equalList.unit,required:!0,value:e.target.value}},handleChangeCommandParam(e){const t=this.equalList.filter((t=>t.stdValue==e));this.ruleForm.value={desc:t[0].description,required:!0,value:e}},resetFormData(){this.ruleForm={id:"",deviceParam:"",operationSign:"equal",desc:""},this.equalList=null,this.selectedWeatherCondition=[],this.$refs.diffForm.resetFields(),this.operationSignList=[{name:"equal",value:"等于"}]}}};const R=(0,L.Z)(H,[["render",j]]);var z=R;function Z(e,t,a,r,o,n){const i=(0,l.resolveComponent)("el-option"),s=(0,l.resolveComponent)("el-select"),u=(0,l.resolveComponent)("el-form-item"),c=(0,l.resolveComponent)("el-input"),d=(0,l.resolveComponent)("el-form");return(0,l.openBlock)(),(0,l.createBlock)(d,{ref:"diffForm",model:o.ruleForm,rules:o.rules,class:"geography-condition common-form","label-width":"100px","label-position":"top"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(u,{label:"设备命令",prop:"id"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.id,"onUpdate:modelValue":t[0]||(t[0]=e=>o.ruleForm.id=e),style:{width:"100%"},placeholder:"请选择设备命令","popper-class":"selectCustomAttrs",onChange:n.handleDeviceCommand},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.deviceCommandList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.id,label:e.description,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,l.createElementVNode)("div",null,[(0,l.createVNode)(u,{label:"命令参数",class:"deviceParam"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.operationSign,"onUpdate:modelValue":t[1]||(t[1]=e=>o.ruleForm.operationSign=e),style:{width:"80px"},"popper-class":"selectCustomAttrs",disabled:""==o.ruleForm.id},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.operationSignList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.name,label:e.value,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"]),o.selectedWeatherCondition.length>0&&"enum"==o.selectedWeatherCondition[0].valType||""==o.ruleForm.id?((0,l.openBlock)(),(0,l.createBlock)(u,{key:0,prop:"deviceParam",class:"deviceParamSelect"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.deviceParam,"onUpdate:modelValue":t[2]||(t[2]=e=>o.ruleForm.deviceParam=e),style:{"margin-left":"16px",width:"199%"},disabled:""==o.ruleForm.id,placeholder:"请选择参数","popper-class":"selectCustomAttrs",onChange:n.handleChangeCommandParam},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.equalList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.stdValue,label:e.description,value:e.stdValue},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled","onChange"])])),_:1})):(0,l.createCommentVNode)("",!0)])),_:1})]),(0,l.createVNode)(u,{label:"条件描述",style:{width:"100%"}},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{modelValue:o.ruleForm.desc,"onUpdate:modelValue":t[3]||(t[3]=e=>o.ruleForm.desc=e),type:"textarea",maxlength:"100",rows:2,class:(0,l.normalizeClass)({"input-focus":o.inputFocus}),"show-word-limit":"",placeholder:"请填写条件描述，最多100字符",onFocus:t[4]||(t[4]=e=>o.inputFocus=!0),onBlur:t[5]||(t[5]=e=>o.inputFocus=!1)},null,8,["modelValue","class"])])),_:1})])),_:1},8,["model","rules"])}var W={props:{singData:{type:Object,default(){return{}}}},data(){return{inputFocus:!1,ruleForm:{componentId:"",id:"",deviceParam:"",operationSign:"equal",desc:"",key:{desc:"",id:"",value:""},value:{desc:"",required:!0,value:""}},source:this.$route.query.source||"",rules:{id:[{required:!0,message:"请选择设备命令",trigger:"change"}],deviceParam:[{required:!0,message:"命令参数数据格式不合法，请重新填写",trigger:"change"}]},deviceCommandList:[],selectedWeatherCondition:[],equalList:null,operationSignList:[{name:"equal",value:"等于"}]}},watch:{"ruleForm.id":{handler(e){if(e){const t=this.deviceCommandList.filter((t=>t.id==e));this.ruleForm.key={desc:t[0].description,id:t[0].id,value:t[0].name},this.ruleForm.componentId=t[0].componentId,"enum"==t[0].valType&&(this.equalList=JSON.parse(t[0].variants),t[0].isLegal=!0,this.operationSignList=[{name:"equal",value:"等于"}],t[0].operationSign="equal"),this.selectedWeatherCondition=t,this.ruleForm.operationSign=this.operationSignList[0].name}}}},mounted(){this.$refs.diffForm.clearValidate(),this.getDeivceCommand()},methods:{getDeivceCommand(){let e;e="southeastAsia"===this.source?"/developerportal/dny/developer/component/cmptPropList/GEOFENCE":"/developerportal/developer/component/cmptPropList/GEOFENCE",(0,B.U)("get",e).then((e=>{"00000"===e.retCode&&(this.deviceCommandList=e.data)})).then((()=>{"{}"!==JSON.stringify(this.singData)&&(this.ruleForm={...this.singData},this.$set(this.ruleForm,"deviceParam",this.singData.value.value),this.ruleForm.id=this.singData.key.id)}))},handleDeviceCommand(){this.$refs.diffForm.clearValidate("deviceParam")},handleChangeCommandParam(e){const t=this.equalList.filter((t=>t.stdValue==e));this.ruleForm.value={desc:t[0].description,required:!0,value:e}},resetFormData(){this.ruleForm={id:"",deviceParam:"",operationSign:"equal",desc:""},this.equalList=null,this.selectedWeatherCondition=[],this.$refs.diffForm.resetFields(),this.operationSignList=[{name:"equal",value:"等于"}]}}};const G=(0,L.Z)(W,[["render",Z]]);var K=G;const X=(0,l.createElementVNode)("span",null,"无",-1),Q={key:2,class:"diff-param"},Y={class:"command-param"},ee={class:"command-left"},te={key:0,class:"command-right"},ae={key:1,class:"command-right"},re={class:"input-style"},oe={key:2,class:"device-unit"},le={class:"device-unit"};function ne(e,t,a,r,o,n){const i=(0,l.resolveComponent)("el-option"),s=(0,l.resolveComponent)("el-select"),u=(0,l.resolveComponent)("el-form-item"),c=(0,l.resolveComponent)("el-input"),d=(0,l.resolveComponent)("el-checkbox"),m=(0,l.resolveComponent)("h-button"),p=(0,l.resolveComponent)("el-form");return(0,l.openBlock)(),(0,l.createBlock)(p,{ref:"diffForm",class:"command-action common-form",model:o.ruleForm,rules:o.rules,"label-width":"120px","label-position":"top"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(u,{label:"设备产品类型",prop:"componentId"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.componentId,"onUpdate:modelValue":t[0]||(t[0]=e=>o.ruleForm.componentId=e),"popper-class":"selectCustomAttrs",filterable:"",placeholder:"请选择设备产品类型"},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.deviceProductTypeList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.id,label:e.prodtypeName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.createVNode)(u,{label:"设备命令",prop:"deviceCommand"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.deviceCommand,"onUpdate:modelValue":t[1]||(t[1]=e=>o.ruleForm.deviceCommand=e),"popper-class":"selectCustomAttrs",filterable:"",placeholder:"请选择设备命令",onChange:n.handleDeviceCommandList},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.deviceCommandList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.id,label:e.description,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),o.ruleForm.deviceSkillObject.length>0&&o.ruleForm.isDeviceSkill?((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:0},(0,l.renderList)(o.ruleForm.deviceSkillObject,((e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:e.id,class:"diff-param"},[(0,l.createVNode)(u,{label:"参数名称"},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("span",null,(0,l.toDisplayString)(e.description),1)])),_:2},1024),"enum"===e.propValType||"bool"===e.propValType?((0,l.openBlock)(),(0,l.createBlock)(u,{key:0,label:"参数值",prop:"deviceSkillObject."+t+".param",rules:[{required:!0,message:"参数值不能为空",trigger:"change"}]},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:e.param,"onUpdate:modelValue":t=>e.param=t,placeholder:"请选择参数","popper-class":"selectCustomAttrs",onChange:e=>n.handleSkillSelect(e,t,"select")},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.variantsList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.stdValue,label:e.description,value:e.stdValue},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:2},1032,["prop"])):((0,l.openBlock)(),(0,l.createBlock)(u,{key:1,label:"参数值",prop:"deviceSkillObject."+t+".param",rules:[{required:!0,message:"参数值不能为空",trigger:"blur"},{validator:(t,a,r)=>{n.getVariantsValue(e,a,r)}}]},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{modelValue:e.param,"onUpdate:modelValue":t=>e.param=t,style:{width:"100%"},placeholder:e.variantsList?""+("请输入"+e.variantsList.minValue+"到"+e.variantsList.maxValue+",步长:"+e.variantsList.step):"请输入字符串值",onChange:e=>n.handleSkillSelect(e,t,"input")},null,8,["modelValue","onUpdate:modelValue","placeholder","onChange"])])),_:2},1032,["prop","rules"])),(0,l.createVNode)(u,{label:"用户编辑",prop:"deviceSkillObject."+t+".require",class:"checkbox-style"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(d,{modelValue:e.require,"onUpdate:modelValue":t=>e.require=t,onChange:e=>n.handleSkillSelect(e,t,"check")},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("支持")])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:2},1032,["prop"])])))),128)):0===o.ruleForm.deviceSkillObject.length&&o.ruleForm.isDeviceSkill?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createVNode)(u,{label:"命令参数",prop:"commandParam"},{default:(0,l.withCtx)((()=>[X])),_:1}),(0,l.createVNode)(u,{label:"用户编辑",class:"checkbox-style"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(d,{disabled:!0},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("支持")])),_:1})])),_:1})],64)):((0,l.openBlock)(),(0,l.createElementBlock)("div",Q,[(0,l.createVNode)(u,{label:"命令参数",class:"my-select-input deviceParam"},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",Y,[(0,l.createElementVNode)("div",ee,[(0,l.createVNode)(m,{type:"third",disabled:"group"==o.ruleForm.propClass||o.ruleForm.isSkill},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("定量")])),_:1},8,["disabled"])]),""!==o.ruleForm.deviceCommand&&"group"!==o.ruleForm.propClass&&"skill"!==o.ruleForm.propClass?((0,l.openBlock)(),(0,l.createElementBlock)("div",te,[Array.isArray(o.ruleForm.variantsList)?((0,l.openBlock)(),(0,l.createBlock)(u,{key:0,prop:"commandParamSelect"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.commandParamSelect,"onUpdate:modelValue":t[2]||(t[2]=e=>o.ruleForm.commandParamSelect=e),style:{"max-width":"100%"},placeholder:"请选择参数","popper-class":"selectCustomAttrs",onChange:n.handleChangeCommad},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.ruleForm.variantsList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.stdValue,label:e.description,value:e.stdValue},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):((0,l.openBlock)(),(0,l.createBlock)(u,{key:1,prop:"inputValue"},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",{class:(0,l.normalizeClass)("string"===o.ruleForm.variantsList.propValType?"input-string":"input-style")},[(0,l.createVNode)(c,{modelValue:o.ruleForm.inputValue,"onUpdate:modelValue":t[3]||(t[3]=e=>o.ruleForm.inputValue=e),type:"text",placeholder:o.inputPlaceHolder,onBlur:n.handleChangeInput},null,8,["modelValue","placeholder","onBlur"])],2)])),_:1}))])):(0,l.createCommentVNode)("",!0),"skill"===o.ruleForm.propClass&&o.ruleForm.variantsList.length>0?((0,l.openBlock)(),(0,l.createElementBlock)("div",ae,[Array.isArray(o.ruleForm.variantsList)?((0,l.openBlock)(),(0,l.createBlock)(u,{key:0,prop:"commandParamSelect"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.commandParamSelect,"onUpdate:modelValue":t[4]||(t[4]=e=>o.ruleForm.commandParamSelect=e),placeholder:"请选择参数","popper-class":"selectCustomAttrs",onChange:n.handleSkillChangeCommad},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.ruleForm.variantsList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.id,label:e.description,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):((0,l.openBlock)(),(0,l.createBlock)(u,{key:1,prop:"inputValue"},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",re,[(0,l.createVNode)(c,{modelValue:o.ruleForm.inputValue,"onUpdate:modelValue":t[5]||(t[5]=e=>o.ruleForm.inputValue=e),type:"text",placeholder:o.inputPlaceHolder,onBlur:n.handleChangeInput},null,8,["modelValue","placeholder","onBlur"])])])),_:1}))])):(0,l.createCommentVNode)("",!0),!Array.isArray(o.ruleForm.variantsList)&&o.ruleForm.variantsList&&o.ruleForm.variantsList.unit?((0,l.openBlock)(),(0,l.createElementBlock)("div",oe,[(0,l.createElementVNode)("span",le,(0,l.toDisplayString)(o.ruleForm.variantsList.unit),1)])):(0,l.createCommentVNode)("",!0)])])),_:1}),""!==o.ruleForm.commandParamSelect&&o.ruleForm.deviceSkillObject.length>0&&("enum"===o.ruleForm.deviceSkillObject[0].propValType||"bool"===o.ruleForm.deviceSkillObject[0].propValType)?((0,l.openBlock)(),(0,l.createBlock)(u,{key:0,prop:"paramSelectSet",label:"参数配置"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{modelValue:o.ruleForm.paramSelectSet,"onUpdate:modelValue":t[6]||(t[6]=e=>o.ruleForm.paramSelectSet=e),placeholder:"请选择参数","popper-class":"selectCustomAttrs",onChange:n.handleChangeSelectParamSet},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.ruleForm.variantsParamList,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e.stdValue,label:e.description,value:e.stdValue},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):(0,l.createCommentVNode)("",!0),""!==o.ruleForm.commandParamSelect&&o.ruleForm.deviceSkillObject.length>0&&("string"===o.ruleForm.deviceSkillObject[0].propValType||"int"===o.ruleForm.deviceSkillObject[0].propValType||"double"===o.ruleForm.deviceSkillObject[0].propValType)?((0,l.openBlock)(),(0,l.createBlock)(u,{key:1,prop:"paramInputSet",label:"参数配置"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{modelValue:o.ruleForm.paramInputSet,"onUpdate:modelValue":t[7]||(t[7]=e=>o.ruleForm.paramInputSet=e),style:{width:"100%"},onBlur:n.handleChangeParamSet},null,8,["modelValue","onBlur"])])),_:1})):(0,l.createCommentVNode)("",!0),(0,l.createVNode)(u,{label:"用户编辑",class:"checkbox-style"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(d,{modelValue:o.ruleForm.isRequired,"onUpdate:modelValue":t[8]||(t[8]=e=>o.ruleForm.isRequired=e),disabled:"group"==o.ruleForm.propClass||o.ruleForm.isSkill},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("支持")])),_:1},8,["modelValue","disabled"])])),_:1})])),(0,l.createVNode)(u,{label:"动作描述"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{modelValue:o.ruleForm.description,"onUpdate:modelValue":t[9]||(t[9]=e=>o.ruleForm.description=e),maxlength:"100",type:"textarea",class:(0,l.normalizeClass)({"input-focus":o.inputFocus}),"show-word-limit":"",placeholder:"请填写动作描述，最多100字符",onFocus:t[10]||(t[10]=e=>o.inputFocus=!0),onBlur:t[11]||(t[11]=e=>o.inputFocus=!1)},null,8,["modelValue","class"])])),_:1})])),_:1},8,["model","rules"])}var ie={props:{fragmentListData:{type:Object,default(){return{}}},singData:{type:Object,default(){return{}}}},data(){return{inputFocus:!1,ruleForm:{componentId:"",deviceCommand:"",stdDesc:"",isRequired:!1,description:"",deviceSkillObject:[{param:"",require:!1}],args:[],operation:{desc:"",id:"",value:""},variantsParamList:null,isDeviceSkill:!1,isSkill:!1,propClass:"",variantsList:null,inputValue:"",commandParamSelect:"",paramSelectSet:"",paramInputSet:""},source:this.$route.query.source||"",rules:{componentId:[{required:!0,message:"请选择设备产品类型",trigger:"change"}],deviceCommand:[{required:!0,message:"请选择设备命令",trigger:"change"}],commandParamSelect:[{required:!0,message:"请选择命令参数",trigger:"blur"}],paramSelectSet:[{required:!0,message:"请选择参数配置",trigger:"change"}],paramInputSet:[{required:!0,message:"请输入参数配置",trigger:"blur"}],inputValue:[{required:!0,message:"请输入命令参数",trigger:"blur"},{validator:(e,t,a)=>{console.log(e,t,a),console.log(this.ruleForm.variantsList,"---");const r={variantsList:this.ruleForm.variantsList,propValType:this.ruleForm.variantsList.propValType};this.getVariantsValue(r,t,a)},trigger:"blur"}]},deviceSkillObjectRules:{deviceSkillObjectId:[{required:!0,message:"jaaa",trigger:"blur"},{validator:(e,t,a)=>{console.log(e,t,a)}}],deviceSkillObjectDesc:[{required:!0,message:"jaaa",trigger:"blur"},{validator:(e,t,a)=>{console.log(e),console.log(t),console.log(a)}}]},deviceProductTypeList:[],deviceCommandList:[],sceneDeviceCondition:{sceneInfo:null,status:null,FragmentList:null,triggerType:null},inputPlaceHolder:"",editData:this.singData}},watch:{"ruleForm.componentId":{handler(e,t){if(e){t&&e!==t&&(this.editData={});const a=this.deviceProductTypeList.filter((t=>t.id===e));this.ruleForm.stdDesc=a[0].prodtypeName,this.handleDeviceCommand()}},immediate:!0,deep:!0}},mounted(){this.handleDeviceProductType()},methods:{handleDeviceProductType(){let e;e="southeastAsia"===this.source?"/developerportal/dny/developer/prodtype/getAllProdtypeList":"/developerportal/developer/prodtype/getAllProdtypeList",(0,B.U)("post",e).then((e=>{if("00000"===e.retCode)return this.deviceProductTypeList=e.data,!0})).then((()=>{"{}"!==JSON.stringify(this.editData)&&(this.ruleForm.componentId=this.editData.control.componentId)}))},handleDeviceCommand(){let e;e="southeastAsia"===this.source?"/developerportal/dny/developer/prodtypeFunction/getProdtypeActionFunctionList":"/developerportal/developer/prodtypeFunction/getProdtypeActionFunctionList",(0,B.U)("post",e,{prodtypeId:this.ruleForm.componentId}).then((e=>{if("00000"===e.retCode)return e.data.map((e=>{console.log(e.type,e.valType,"----"),"skill"==e.type&&(e.description="(语音)"+e.description),"deviceSkill"==e.type&&(e.description="(技)"+e.description)})),this.deviceCommandList=e.data,this.$nextTick((()=>{this.$refs.diffForm.clearValidate("deviceCommand"),this.ruleForm.isDeviceSkill=!1,this.ruleForm.isSkill=!1,this.ruleForm.deviceSkillObject=[],this.ruleForm.args=[],this.ruleForm.variantsParamList=null,this.ruleForm.variantsList=null,this.ruleForm.inputValue="",this.ruleForm.commandParamSelect="",this.ruleForm.paramSelectSet="",this.ruleForm.paramInputSet="",this.ruleForm.propClass="",this.ruleForm.operation={desc:"",id:"",value:""}})),this.ruleForm.deviceCommand="",!0})).then((()=>{"{}"!==JSON.stringify(this.editData)&&(this.editData.control.args&&!this.editData.control.operation?this.ruleForm.deviceCommand=this.editData.control.args[0].name.id:this.ruleForm.deviceCommand=this.editData.control.operation.id,this.handleDeviceCommandList(this.ruleForm.deviceCommand))}))},handleDeviceCommandList(e){console.log("选中的值",e),this.$refs.diffForm.clearValidate(),this.ruleForm.isDeviceSkill=!1,this.ruleForm.isSkill=!1,this.ruleForm.deviceSkillObject=[],this.ruleForm.args=[],this.ruleForm.variantsParamList=null,this.ruleForm.variantsList=null,this.ruleForm.isRequired=!1,this.ruleForm.inputValue="",this.ruleForm.paramSelectSet="",this.ruleForm.paramInputSet="",this.ruleForm.commandParamSelect="","{}"!==JSON.stringify(this.editData)&&(this.editData.control.args&&!this.editData.control.operation?e!==this.editData.control.args[0].name.id?(this.editData={},this.$set(this.ruleForm,"args",[])):this.$set(this.ruleForm,"args",this.editData.control.args):e!==this.editData.control.operation.id?(this.editData={},this.$set(this.ruleForm,"args",[])):this.$set(this.ruleForm,"args",this.editData.control.args));const t=this.deviceCommandList.filter((t=>t.id===e));if("{}"!==JSON.stringify(this.editData)&&this.$set(this.ruleForm,"description",this.editData.description),"property"===t[0].type){this.ruleForm.isDeviceSkill=!1,this.ruleForm.isSkill=!1,this.ruleForm.propClass="";const e={name:{desc:t[0].description,id:t[0].id,value:t[0].propName}};if("{}"===JSON.stringify(this.editData)&&this.ruleForm.args.push(e),"int"==t[0].valType){const e=JSON.parse(t[0].variants);this.inputPlaceHolder="请输入"+e.minValue+"到"+e.maxValue+",步长:"+e.step,this.ruleForm.variantsList=e,this.ruleForm.variantsList.propValType=t[0].valType,"{}"!==JSON.stringify(this.editData)&&(this.$set(this.ruleForm,"inputValue",this.editData.control.args[0].value.value),this.$set(this.ruleForm,"isRequired",this.editData.control.args[0].value.required))}else if("bool"==t[0].valType||"enum"==t[0].valType){const e=JSON.parse(t[0].variants);e.map((e=>{"string"!==typeof e.stdValue&&(e.stdValue=e.stdValue+"")})),this.ruleForm.variantsList=e,"{}"!==JSON.stringify(this.editData)&&(this.$set(this.ruleForm,"commandParamSelect",this.editData.control.args[0].value.value),this.$set(this.ruleForm,"isRequired",this.editData.control.args[0].value.required)),console.log(this.ruleForm.variantsList,"pro")}else if("double"==t[0].valType){const e=JSON.parse(t[0].variants);this.inputPlaceHolder="请输入"+e.minValue+"到"+e.maxValue+",步长:"+e.step,this.ruleForm.variantsList=e,this.ruleForm.variantsList.propValType=t[0].valType,"{}"!==JSON.stringify(this.editData)&&(this.$set(this.ruleForm,"inputValue",this.editData.control.args[0].value.value),this.$set(this.ruleForm,"isRequired",this.editData.control.args[0].value.required))}else if("string"==t[0].valType){if(console.log(t[0],"data------------"),t[0].variants){const e=JSON.parse(t[0].variants);e.minValue?(this.inputPlaceHolder="请输入"+e.minValue+"到"+e.maxValue+",步长:"+e.step,this.ruleForm.variantsList=e,this.ruleForm.variantsList.propValType=t[0].valType):this.ruleForm.variantsList={propValType:t[0].valType}}else this.ruleForm.variantsList={propValType:"string"};"{}"!==JSON.stringify(this.editData)&&(this.$set(this.ruleForm,"inputValue",this.editData.control.args[0].value.value),this.$set(this.ruleForm,"isRequired",this.editData.control.args[0].value.required))}}"group"===t[0].type&&(console.log(222),this.ruleForm.isDeviceSkill=!1,this.ruleForm.isSkill=!1,this.ruleForm.propClass="group",this.ruleForm.operation={desc:t[0].stdDescription,id:t[0].id,value:t[0].name},console.log("group")),"skill"===t[0].type&&(this.ruleForm.isDeviceSkill=!1,this.ruleForm.propClass="skill",this.ruleForm.operation={desc:t[0].stdDescription,id:t[0].id,value:t[0].name},this.ruleForm.deviceSkillObject=t[0].prodtypeFunctionSubDtoList?t[0].prodtypeFunctionSubDtoList:[],this.ruleForm.variantsList=this.ruleForm.deviceSkillObject,this.ruleForm.deviceSkillObject.length>0?(this.ruleForm.isSkill=!1,this.ruleForm.deviceSkillObject.map((e=>{const t={name:{desc:e.description,id:e.id,required:!1,value:e.propName},value:{desc:"",required:!1,value:""}};"{}"===JSON.stringify(this.editData)&&this.ruleForm.args.push(t),e.variants&&(this.ruleForm.variantsParamList=this.isJSON_test(e.variants)?JSON.parse(e.variants):[]),console.log(this.ruleForm.variantsParamList,"this.ruleForm.variantsParamList"),"{}"!==JSON.stringify(this.editData)&&(this.$set(this.ruleForm,"commandParamSelect",this.singData.control.args[0].name.id),this.$set(this.ruleForm,"paramSelectSet",this.singData.control.args[0].value.value),this.$set(this.ruleForm,"paramInputSet",this.singData.control.args[0].value.value),this.$set(this.ruleForm,"isRequired",this.editData.control.args[0].value.required))})),console.log(this.ruleForm.args,"---this.ruleForm.args")):(this.ruleForm.args=[],this.ruleForm.isSkill=!0)),"deviceSkill"===t[0].type&&(console.log(444),this.ruleForm.isSkill=!1,this.ruleForm.propClass="deviceSkill",this.ruleForm.operation={desc:t[0].stdDescription,id:t[0].id,value:t[0].name},this.ruleForm.isDeviceSkill=!0,this.ruleForm.deviceSkillObject=t[0].prodtypeFunctionSubDtoList?t[0].prodtypeFunctionSubDtoList:[],this.ruleForm.deviceSkillObject.length>0?this.ruleForm.deviceSkillObject.map(((e,t)=>{this.$set(e,"param","");const a={name:{desc:e.description,id:e.id,required:!1,value:e.propName},value:{desc:"",required:!1,value:""}};if(console.log(e,"item------"),e.variants){let t;"enum"==e.propValType||"bool"==e.propValType?(t=this.isJSON_test(e.variants)?JSON.parse(e.variants):[],t.map((e=>{"string"!==typeof e.stdValue&&(e.stdValue=e.stdValue+"")}))):t=this.isJSON_test(e.variants)?JSON.parse(e.variants):"",e.variantsList=t}"{}"===JSON.stringify(this.editData)&&this.ruleForm.args.push(a),"{}"!==JSON.stringify(this.editData)?(this.$set(e,"param",this.editData.control.args[t].value.value),this.$set(e,"require",this.editData.control.args[t].value.required)):e.require=!1})):this.ruleForm.args=[]),console.log(t,"data------")},isJSON_test(e){if("string"==typeof e)try{var t=JSON.parse(e);return console.log("转换成功："+t),!0}catch(a){return!1}},getVariantsValue(e,t,a){if(e.variantsList&&t){if("double"===e.propValType&&(this.$vertifyMethods.isDouble(t,2)||a("数据不符合要求"),parseFloat(t)<parseFloat(e.variantsList.minValue)||parseFloat(t)>parseFloat(e.variantsList.maxValue)||parseFloat(t)%parseFloat(e.variantsList.step)!==0?a("参数值数据格式不合法，请重新填写"):a()),"int"===e.propValType){let r=/^[0-9]*$/;r.test(t)||a("数据不符合要求"),Number(t)<Number(e.variantsList.minValue)||Number(t)>Number(e.variantsList.maxValue)||Number(t)%Number(e.variantsList.step)!==0?a("参数值数据格式不合法，请重新填写"):a()}"string"===e.propValType&&a()}else a()},handleSkillSelect(e,t,a){console.log(e,t,a),"select"===a?this.ruleForm.deviceSkillObject[t].variantsList.filter((a=>{a.stdValue===e&&(this.ruleForm.args[t].value={desc:a.description,required:this.ruleForm.deviceSkillObject[t].require,value:e})})):"input"===a?this.ruleForm.args[t].value={desc:e,required:this.ruleForm.deviceSkillObject[t].require,value:e}:(this.$set(this.ruleForm.deviceSkillObject[t],"require",e),console.log(this.ruleForm.args,"this.ruleForm.args"),this.ruleForm.args[t].value.required=e,this.$forceUpdate())},resetFormData(){this.$refs.diffForm.resetFields()},handleChangeCommad(e){console.log(e,"e----"),e&&this.$refs.diffForm.clearValidate("commandParamSelect"),console.log(this.ruleForm.variantsList," this.ruleForm.variantsList");const t=this.ruleForm.variantsList.filter((t=>t.stdValue===e));this.ruleForm.args[0].value={desc:t[0].description,value:e,required:this.ruleForm.isRequired}},handleSkillChangeCommad(e){e&&this.$refs.diffForm.clearValidate("commandParamSelect"),console.log(this.ruleForm.variantsList," this.ruleForm.variantsList");const t=this.ruleForm.variantsList.filter((t=>t.id===e));this.ruleForm.args[0].value={desc:t[0].description,value:e,required:this.ruleForm.isRequired}},handleChangeSelectParamSet(e){const t=this.ruleForm.variantsParamList.filter((t=>t.stdValue===e));this.ruleForm.args[0].value={desc:t[0].description,value:e,required:this.ruleForm.isRequired}},handleChangeParamSet(e){let t;console.log(e,"eeeeee"),t=this.ruleForm.variantsList.unit?e.target.value+this.ruleForm.variantsList.unit:e.target.value,this.ruleForm.args[0].value={desc:t,value:e.target.value,required:this.ruleForm.isRequired},console.log(this.ruleForm.args[0].value,"this.ruleForm.args[0].value")},handleChangeInput(e){let t;this.ruleForm.variantsList.unit&&(t=e.target.value+this.ruleForm.variantsList.unit),this.ruleForm.args[0].value={desc:t||e.target.value,value:e.target.value,required:this.ruleForm.isRequired},console.log(this.ruleForm.args[0].value)}}};const se=(0,L.Z)(ie,[["render",ne]]);var ue=se,ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAMCAYAAACNzvbFAAAAAXNSR0IArs4c6QAAAcpJREFUOE+lkkFIFHEUxn9vdnZ0MqVL0SGCWg956OAhKOmSEBREgSVFRHWJpohMT0URXSoWKg9BLeEh2DoEIWwUVmCkdIiMIkjyohfr4CHCHdrZ2RnnxSi6u4m24YP/7f1/7/ve+6TZySsrKVVXxRhRtHci0/Q8RsmKoQuCRBW9OZ5pulwFtS0wpCxbFXoO1HE75+OVarEjGqH7q6D9F1eRWm9gmfC7CGcyHjtbEtx7WcIPaoGCIm8W2e/YbtKxI8mxXo9kAuJBB9MFrh2pY3W9zA6d/BnR1VdkT6vJqd0W8VEO3ypQ8AFVd1lorHj0biNbz7v0nbMZ/BKSHQoYuNrAjadFTrZbDH0NeTwcVDn5L+iD1yWGR2fIXrB58i5gYirixK4kbVtMDqULTE3PBUmaT0/nEWmc31il/b+V/nKV3EhA+rjN0TsFNq0zCCPlSmc9TsZj7Hs0B0057qCg7fPQlg0G8et/H5Iw4Oxei/sDJR522Xwan8FKwrfJiNyHkM42k41rDcZ+RLz4GJbDtdnJ7zOQZ6AVYVp86UfdNtm3Aa8+lz8vlYdZUMrJXxfk0nLgNQ3g+eD/m8mCulixIN2i0bbKHdeWzuquP8g4wunbkgduAAAAAElFTkSuQmCC";const de={class:"startTime"},me=(0,l.createElementVNode)("span",{style:{margin:"0 5px"}},"时",-1),pe=(0,l.createElementVNode)("span",{style:{"margin-left":"5px"}},"分",-1),he={class:"endTime"},ve=(0,l.createElementVNode)("span",{style:{margin:"0 5px"}},"时",-1),ge=(0,l.createElementVNode)("span",{style:{"margin-left":"5px"}},"分",-1),fe=(0,l.createElementVNode)("p",{class:"tip-title"},[(0,l.createElementVNode)("img",{src:ce,alt:"",class:"tip-image"}),(0,l.createElementVNode)("span",{class:"tip-name"},"注释")],-1),ye=(0,l.createElementVNode)("p",{class:"tip-content"}," 支持参数类型：${device.nickname} 设备昵称 支持编辑带参数的消息，消息内容如需要插入参数，直接将参数粘贴到消息内。例如：“您好！您的${device.nickname}检测到漏水，请及时处理” ",-1);function ke(e,t,a,r,o,n){const i=(0,l.resolveComponent)("el-checkbox"),s=(0,l.resolveComponent)("el-option"),u=(0,l.resolveComponent)("el-select"),c=(0,l.resolveComponent)("el-form-item"),d=(0,l.resolveComponent)("el-input"),m=(0,l.resolveComponent)("el-form");return(0,l.openBlock)(),(0,l.createBlock)(m,{ref:"diffForm",model:o.ruleForm,class:"common-form",rules:o.rules,"label-width":"100px","label-position":"top"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{label:"免打扰模式",prop:"terminalStartHour",class:"noDisturb"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(i,{modelValue:o.ruleForm.terminalTime,"onUpdate:modelValue":t[0]||(t[0]=e=>o.ruleForm.terminalTime=e),onChange:n.handleChangeTerminalTime},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("支持")])),_:1},8,["modelValue","onChange"]),(0,l.createElementVNode)("div",de,[(0,l.createVNode)(u,{modelValue:o.ruleForm.terminalStartHour,"onUpdate:modelValue":t[1]||(t[1]=e=>o.ruleForm.terminalStartHour=e),style:{width:"80px"},"popper-class":"selectCustomAttrs",placeholder:"",disabled:!o.ruleForm.terminalTime},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.setHour,(e=>((0,l.openBlock)(),(0,l.createBlock)(s,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"]),me,(0,l.createVNode)(u,{modelValue:o.ruleForm.terminalStartMinutes,"onUpdate:modelValue":t[2]||(t[2]=e=>o.ruleForm.terminalStartMinutes=e),style:{width:"80px"},"popper-class":"selectCustomAttrs",placeholder:"",disabled:!o.ruleForm.terminalTime},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.setMinutes,(e=>((0,l.openBlock)(),(0,l.createBlock)(s,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"]),pe]),(0,l.createElementVNode)("div",he,[(0,l.createVNode)(u,{modelValue:o.ruleForm.terminalEndHour,"onUpdate:modelValue":t[3]||(t[3]=e=>o.ruleForm.terminalEndHour=e),style:{width:"80px"},"popper-class":"selectCustomAttrs",placeholder:"",disabled:!o.ruleForm.terminalTime},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.setHour,(e=>((0,l.openBlock)(),(0,l.createBlock)(s,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"]),ve,(0,l.createVNode)(u,{modelValue:o.ruleForm.terminalEndMinutes,"onUpdate:modelValue":t[4]||(t[4]=e=>o.ruleForm.terminalEndMinutes=e),style:{width:"80px"},"popper-class":"selectCustomAttrs",placeholder:"",disabled:!o.ruleForm.terminalTime},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.setMinutes,(e=>((0,l.openBlock)(),(0,l.createBlock)(s,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"]),ge])])),_:1}),(0,l.createVNode)(c,{label:"间隔时间",prop:"intervalHours",class:"noDisturb"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(i,{modelValue:o.ruleForm.intervalTime,"onUpdate:modelValue":t[5]||(t[5]=e=>o.ruleForm.intervalTime=e),onChange:n.handleChangeTntervalTime},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("支持")])),_:1},8,["modelValue","onChange"]),(0,l.createVNode)(u,{modelValue:o.ruleForm.intervalHours,"onUpdate:modelValue":t[6]||(t[6]=e=>o.ruleForm.intervalHours=e),class:"startTime",placeholder:"",style:{width:"100px"},"popper-class":"selectCustomAttrs",disabled:!o.ruleForm.intervalTime},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.setIntervalHour,(e=>((0,l.openBlock)(),(0,l.createBlock)(s,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"]),(0,l.createVNode)(u,{modelValue:o.ruleForm.intervalMinutes,"onUpdate:modelValue":t[7]||(t[7]=e=>o.ruleForm.intervalMinutes=e),placeholder:"",style:{width:"100px","margin-left":"15px"},"popper-class":"selectCustomAttrs",disabled:!o.ruleForm.intervalTime},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.setIntervalMinutes,(e=>((0,l.openBlock)(),(0,l.createBlock)(s,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1}),(0,l.createVNode)(c,{label:"终端类型",prop:"terminalType"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(u,{modelValue:o.ruleForm.terminalType,"onUpdate:modelValue":t[8]||(t[8]=e=>o.ruleForm.terminalType=e),multiple:"",placeholder:"请选择终端类型","popper-class":"selectCustomAttrs",style:{width:"100%"}},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.terminalTypeList,(e=>((0,l.openBlock)(),(0,l.createBlock)(s,{key:e.configCode,label:e.description,value:e.configCode},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.createVNode)(c,{label:"弹窗类型",prop:"toastType"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(u,{modelValue:o.ruleForm.toastType,"onUpdate:modelValue":t[9]||(t[9]=e=>o.ruleForm.toastType=e),placeholder:"请选择弹窗类型","popper-class":"selectCustomAttrs toast-maxwidth",style:{width:"100%"}},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.toastTypeList,(e=>((0,l.openBlock)(),(0,l.createBlock)(s,{key:e.configCode,label:e.description,value:e.configCode},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.createVNode)(c,{label:"消息优先级",prop:"messagePriority"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(u,{modelValue:o.ruleForm.messagePriority,"onUpdate:modelValue":t[10]||(t[10]=e=>o.ruleForm.messagePriority=e),style:{width:"100%"},"popper-class":"selectCustomAttrs",placeholder:""},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.messagePriorityList,(e=>((0,l.openBlock)(),(0,l.createBlock)(s,{key:e.key,label:e.value,value:e.key},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.createVNode)(c,{label:"消息标题",style:{width:"100%"},prop:"messageTitle"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(d,{modelValue:o.ruleForm.messageTitle,"onUpdate:modelValue":t[11]||(t[11]=e=>o.ruleForm.messageTitle=e),placeholder:"请输入推送标题，最多20字符",maxlength:"20"},null,8,["modelValue"])])),_:1}),(0,l.createVNode)(c,{label:"消息内容",style:{width:"100%"},prop:"messageContent"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(d,{modelValue:o.ruleForm.messageContent,"onUpdate:modelValue":t[12]||(t[12]=e=>o.ruleForm.messageContent=e),placeholder:"请输入推送内容，最多20字符",maxlength:"20"},null,8,["modelValue"])])),_:1}),(0,l.createVNode)(c,{class:"tag"},{default:(0,l.withCtx)((()=>[fe,ye])),_:1})])),_:1},8,["model","rules"])}var Ve={props:{singData:{type:Object,default(){return{}}}},data(){return{ruleForm:{terminalTime:!1,terminalStartHour:"00",terminalStartMinutes:"00",terminalEndHour:"00",terminalEndMinutes:"00",intervalTime:!1,intervalHours:"0h",intervalMinutes:"10min",terminalType:[],toastType:"",messagePriority:"1",messageTitle:"",messageContent:""},source:this.$route.query.source||"",rules:{terminalStartHour:[{required:!0,message:"请选择免打扰模式",trigger:"change"}],intervalHours:[{required:!0,message:"请选择间隔时间",trigger:"change"}],terminalType:[{required:!0,message:"请选择终端类型",trigger:"change"}],toastType:[{required:!0,message:"请选择弹窗类型",trigger:"change"}],messageTitle:[{required:!0,message:"请输入消息标题",trigger:"blur"}],messageContent:[{required:!0,message:"请输入消息内容",trigger:"blur"}]},terminalTypeList:[],toastTypeList:[],messagePriorityList:[{key:"0",value:"紧急消息"},{key:"1",value:"一般消息"},{key:"2",value:"中级消息"},{key:"3",value:"低级消息"}],setHour:[],setMinutes:[],setIntervalHour:[],setIntervalMinutes:[]}},mounted(){if(console.log(1111),this.getTerminalType(),this.getToastType(),this.setHour=I.initHMS(24,!0),this.setMinutes=I.initHMS(60,!0),this.setIntervalHour=this.handleSetIntervalHour(),this.setIntervalMinutes=this.handleSetIntervalMinutes(60),"{}"!==JSON.stringify(this.singData)){const e=this.singData.pushMessage.msgStrategy;if(void 0===e.maxCount){console.log(this.singData.pushMessage.msgStrategy,"this.singData.pushMessage.msgStrategy");const e=this.singData.pushMessage.msgStrategy.notWorkTimeStart&&this.singData.pushMessage.msgStrategy.notWorkTimeStart.length>0?this.singData.pushMessage.msgStrategy.notWorkTimeStart.split(":"):"";this.ruleForm.terminalStartHour="object"==typeof e?e[0]:"00",this.ruleForm.terminalStartMinutes="object"==typeof e?e[1]:"00";const t=this.singData.pushMessage.msgStrategy.notWorkTimeEnd&&this.singData.pushMessage.msgStrategy.notWorkTimeEnd.length>0?this.singData.pushMessage.msgStrategy.notWorkTimeEnd.split(":"):"";this.ruleForm.terminalEndHour="object"==typeof t?t[0]:"00",this.ruleForm.terminalEndMinutes="object"==typeof t?t[1]:"00",this.singData.pushMessage.msgStrategy.notWorkTimeStart&&this.singData.pushMessage.msgStrategy.notWorkTimeStart.length>0||this.singData.pushMessage.msgStrategy.notWorkTimeEnd&&this.singData.pushMessage.msgStrategy.notWorkTimeEnd.length>0?this.ruleForm.terminalTime=!0:this.ruleForm.terminalTime=!1,this.handleDealTime(this.singData.pushMessage.msgStrategy.timeInterval)}else null==e.maxCount&&(this.ruleForm={terminalTime:!1,terminalStartHour:"00",terminalStartMinutes:"00",terminalEndHour:"00",terminalEndMinutes:"00",intervalTime:!1,intervalHours:"0h",intervalMinutes:"10min"});this.$set(this.ruleForm,"messageTitle",this.singData.pushMessage.pushContent.msgTitle),this.$set(this.ruleForm,"messageContent",this.singData.pushMessage.pushContent.msgContent),this.$set(this.ruleForm,"messagePriority",this.singData.pushMessage.priority.toString()),this.handleDealShowTypes(this.singData.pushMessage.showTypes)}},methods:{getTerminalType(){let e;e="southeastAsia"===this.source?"/developerportal/dny/developer/config/getConfigType":"/developerportal/developer/config/getConfigType",(0,B.U)("post",e,{configParentCode:"pushTerminalType"}).then((e=>{"00000"==e.retCode&&(this.terminalTypeList=e.data)}))},getToastType(){let e;e="southeastAsia"===this.source?"/developerportal/dny/developer/config/getConfigType":"/developerportal/developer/config/getConfigType",(0,B.U)("post",e,{configParentCode:"pushShowType"}).then((e=>{"00000"==e.retCode&&(this.toastTypeList=e.data)}))},resetFormData(){this.$refs.diffForm.resetFields()},handleSetIntervalHour(){const e=I.initHMS(24);return e.map((e=>e+"h"))},handleSetIntervalMinutes(e){const t=[];for(let a=0;a<e;a+=2)t.push(a.toString()+"min");return t},handleDealTime(e){if(null==e)return;const t=parseInt(e/60);this.ruleForm.intervalHours=parseInt(e/60).toString()+"h",this.ruleForm.intervalMinutes=parseInt(e-60*t).toString()+"min",this.ruleForm.intervalTime=null!==e},handleDealShowTypes(e){const t=[];for(let a in e)t.push(a),this.$set(this.ruleForm,"toastType",e[a]);this.$set(this.ruleForm,"terminalType",t)},handleChangeTerminalTime(e){e||(this.ruleForm.terminalStartHour="00",this.ruleForm.terminalStartMinutes="00",this.ruleForm.terminalEndHour="00",this.ruleForm.terminalEndMinutes="00")},handleChangeTntervalTime(e){e||(this.ruleForm.intervalHours="0h",this.ruleForm.intervalMinutes="10min")}}};const Ce=(0,L.Z)(Ve,[["render",ke]]);var Fe=Ce;const Se={class:"startTime"},be=(0,l.createElementVNode)("span",{style:{margin:"0 10px"}},"小时",-1),Ne=(0,l.createElementVNode)("span",{style:{margin:"0 10px"}},"分钟",-1),we=(0,l.createElementVNode)("span",{style:{"margin-left":"10px"}},"秒",-1);function xe(e,t,a,r,o,n){const i=(0,l.resolveComponent)("el-option"),s=(0,l.resolveComponent)("el-select"),u=(0,l.resolveComponent)("el-form-item"),c=(0,l.resolveComponent)("el-form");return(0,l.openBlock)(),(0,l.createBlock)(c,{ref:"ruleForm",model:o.ruleForm,class:"common-form","label-width":"100px","label-position":"top"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(u,{label:"延时设置",class:"delaySet"},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",Se,[(0,l.createVNode)(s,{modelValue:o.ruleForm.delayStartHour,"onUpdate:modelValue":t[0]||(t[0]=e=>o.ruleForm.delayStartHour=e),"popper-class":"selectCustomAttrs",style:{width:"80px"},placeholder:""},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.setHour,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),be,(0,l.createVNode)(s,{modelValue:o.ruleForm.delayStartMinutes,"onUpdate:modelValue":t[1]||(t[1]=e=>o.ruleForm.delayStartMinutes=e),"popper-class":"selectCustomAttrs",style:{width:"80px"},placeholder:""},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.setMinutes,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),Ne,(0,l.createVNode)(s,{modelValue:o.ruleForm.delayStartSecond,"onUpdate:modelValue":t[2]||(t[2]=e=>o.ruleForm.delayStartSecond=e),"popper-class":"selectCustomAttrs",style:{width:"80px"},placeholder:""},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.setSeconds,(e=>((0,l.openBlock)(),(0,l.createBlock)(i,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),we])])),_:1}),o.ruleForm.isShow?((0,l.openBlock)(),(0,l.createBlock)(u,{key:0,style:{color:"red"}},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("请选择延时时间！")])),_:1})):(0,l.createCommentVNode)("",!0)])),_:1},8,["model"])}var Be={props:{singData:{type:Object,default(){return{}}}},data(){return{ruleForm:{delayStartHour:"0",delayStartMinutes:"0",delayStartSecond:"0",isShow:!1},source:this.$route.query.source||"",setHour:[],setMinutes:[],setSeconds:[],delayData:{}}},mounted(){this.setHour=I.initHMS(24),this.setMinutes=I.initHMS(60),this.setSeconds=I.initHMS(60),this.getDelayData(),"{}"!==JSON.stringify(this.singData)&&this.handleDealHMS(this.singData.delayControl.args[0].value.value)},methods:{getDelayData(){let e;e="southeastAsia"===this.source?"/developerportal/dny/developer/component/cmptPropList/DELAY":"/developerportal/developer/component/cmptPropList/DELAY",(0,B.U)("get",e).then((e=>{"00000"==e.retCode&&(this.delayData=e.data[0])}))},resetFormData(){this.ruleForm={delayStartHour:"0",delayStartMinutes:"0",delayStartSecond:"0",isShow:!1}},handleDealHMS(e){this.ruleForm.delayStartHour=parseInt(e/3600).toString(),this.ruleForm.delayStartMinutes=parseInt((e-3600*this.ruleForm.delayStartHour)/60).toString(),this.ruleForm.delayStartSecond=parseInt((e-3600*this.ruleForm.delayStartHour)%60).toString()}}};const De=(0,L.Z)(Be,[["render",xe]]);var Le,_e=De,Te=(Le={},Le[o.hP]=T,Le[o.fg]=J,Le[o.HT]=z,Le[o.hI]=K,Le[o.Hd]=ue,Le[o._0]=Fe,Le[o.m8]=_e,Le),qe=(0,r.pi)((0,r.pi)({},Te),v),Ee=function(e){var t=e.template;return console.log(t),qe[t]}},6941:function(e,t,a){a.d(t,{j:function(){return E}});var r=a(5991),o=a(8116),l=a(655),n=a(3634),i="checkSamePort",s="checkPortType",u="checkOrPort",c="checkConditionPort";function d(e){var t=e.sourcePort,a=e.targetPort;return!t||!a||t!==a}var m,p=a(3997);function h(e){var t=e.sourcePortType,a=e.targetPortType;if(p.jH.indexOf(t)>=0&&p.$g.indexOf(a)>=0)return!0}function v(e,t,a){return t!==p.fw||!e.getIncomingEdges(a)}function g(e,t,a){return t!==p.FJ||!e.getIncomingEdges(a)}function f(e,t,a){return t!==p.cS||!e.getIncomingEdges(a)&&!e.getOutgoingEdges(a)}function y(e,t){var a=e.targetCell,r=e.sourcePortName,o=e.sourcePortType,l=e.targetPortName,n=e.targetPortType;return console.log(l,a),r!==p.Kc&&l!==p.Kc||!!v(t,n,a)&&(!!g(t,n,a)&&!!f(t,o,a))}function k(e,t){var a=e.targetCell,r=e.sourcePortName,o=e.targetPortName,l=e.targetPortType;return r!==p.r_&&o!==p.r_||(l!==p.fw||!t.getIncomingEdges(a))}var V=(m={},m[i]=d,m[s]=h,m[u]=y,m[c]=k,m),C=V;function F(e,t,a){return function(){var r=e.length,o=!0;if(t.sourcePort&&t.targetPort){var n=t.sourcePort.split("-"),i=n[0],s=n[1],u=t.targetPort.split("-"),c=u[0],d=u[1];console.log(t.targetPort);for(var m=0;m<r;m++)if(!C[e[m]]((0,l.pi)((0,l.pi)({},t),{sourcePortName:i,sourcePortType:s,targetPortName:c,targetPortType:d}),a)){o=!1;break}return o}return!1}}var S=[i,s,u,c];function b(e){return F(S,e,this)()}var N,w={validateConnection:b,snap:{radius:20},allowBlank:!1,allowMulti:!1,allowLoop:!1,allowNode:!1,allowEdge:!0,allowPort:!0,highlight:!0,connector:{name:"rounded",args:{radius:8}},connectionPoint:"anchor",anchor:"center",router:{name:"manhattan",args:{padding:1}},createEdge:function(){return new n.bn.kS({router:"manhattan",attrs:{line:{}},zIndex:-1})}},x="basicEdge",B={autoResize:!0,grid:{type:"mesh",size:20,visible:!0,args:{color:"#eeeeee",thickness:2}},background:!1,panning:{enabled:!0,modifiers:["alt","meta"],eventTypes:["leftMouseDown"]},mousewheel:{enabled:!0,modifiers:"ctrl",factor:1.1,maxScale:1.5,minScale:.5},highlighting:{magnetAvailable:{name:"stroke",args:{attrs:{fill:"#fff",stroke:"#31d0c6",strokeWidth:4}}}},connecting:{snap:!0,allowBlank:!1,allowMulti:!0,allowLoop:!1,allowNode:!1,allowEdge:!0,allowPort:!0,highlight:!0,connector:x,connectionPoint:"anchor",edgeAnchor:"ratio",anchor:"center",router:"normal",edgeMovable:!0,vertexDeletable:!0,validateMagnet:function(){return!0},createEdge:function(){return new n.bn.kS({attrs:{line:{stroke:"#000",strokeWidth:2,targetMarker:{name:"block",width:12,height:8}}},zIndex:1})}}},D=B,L=(0,l.pi)((0,l.pi)({},D),{connecting:w}),_=L,T=(N={},N[o.ef]=_,N),q=T;function E(e){var t=e.templateName,a=e.container,o=e.config,l={container:a};return t?Object.assign(l,q[t]):o&&Object.assign(l,D,o.options||{},{}),(0,r.B)(l)}},8116:function(e,t,a){a.d(t,{ef:function(){return r}});var r="mainPageGraph"},3927:function(e,t,a){a.d(t,{Z:function(){return le}});var r=a(655),o=a(3634),l=a(2681),n=a(8222),i={class:"basic-node"},s={class:"basic-node__desc"},u=["src"],c={class:"node-name"},d=(0,n.defineComponent)({__name:"BasicNode",setup:function(e){var t=(0,n.inject)("getNode"),a=(0,n.ref)(),r=(0,n.ref)({attrData:[]}),o=(0,n.ref)({});return(0,n.onMounted)((function(){t&&(a.value=t(),r.value=a.value.data,o.value=r.value.attrData||{},console.log(r.value),a.value.on("change:data",(function(e){var t=e.current;r.value=t,o.value=r.value.attrData||{}})))})),function(e,t){return(0,n.openBlock)(),(0,n.createElementBlock)("div",i,[(0,n.createElementVNode)("div",s,[(0,n.createElementVNode)("img",{class:"basic-node__icon",src:r.value.icon,alt:""},null,8,u),(0,n.createElementVNode)("div",c,(0,n.toDisplayString)(r.value.description),1)])])}}}),m=a(3744);const p=(0,m.Z)(d,[["__scopeId","data-v-6e1c6eac"]]);var h=p,v={class:"basic-node"},g={class:"node-name"},f=(0,n.defineComponent)({__name:"BasicOrNode",setup:function(e){var t=(0,n.inject)("getNode"),a=(0,n.ref)(),r=(0,n.ref)({attrData:[]}),o=(0,n.ref)({});return(0,n.onMounted)((function(){t&&(a.value=t(),r.value=a.value.data,o.value=r.value.attrData||{},console.log(r.value),a.value.on("change:data",(function(e){var t=e.current;r.value=t,o.value=r.value.attrData||{}})))})),function(e,t){return(0,n.openBlock)(),(0,n.createElementBlock)("div",v,[(0,n.createElementVNode)("div",g,(0,n.toDisplayString)(r.value.description),1)])}}});const y=(0,m.Z)(f,[["__scopeId","data-v-2d08b82d"]]);var k=y,V={class:"basic-node"},C=["src"],F={class:"node-name"},S=(0,n.defineComponent)({__name:"BasicDescisionNode",setup:function(e){var t=(0,n.inject)("getNode"),a=(0,n.ref)(),r=(0,n.ref)({attrData:[]}),o=(0,n.ref)({});return(0,n.onMounted)((function(){t&&(a.value=t(),r.value=a.value.data,o.value=r.value.attrData||{},a.value.on("change:data",(function(e){var t=e.current;r.value=t,o.value=r.value.attrData||{}})))})),function(e,t){return(0,n.openBlock)(),(0,n.createElementBlock)("div",V,[(0,n.createElementVNode)("img",{class:"basic-node__icon",src:r.value.icon,alt:""},null,8,C),(0,n.createElementVNode)("div",F,(0,n.toDisplayString)(o.value.descision||r.value.description),1)])}}});const b=(0,m.Z)(S,[["__scopeId","data-v-d7ea66ee"]]);var N=b,w={class:"basic-node"},x={class:"node-name"},B=(0,n.defineComponent)({__name:"BasicLogicNode",setup:function(e){var t=(0,n.inject)("getNode"),a=(0,n.ref)(),r=(0,n.ref)({attrData:[]});return(0,n.onMounted)((function(){t&&(a.value=t(),r.value=a.value.data,a.value.on("change:data",(function(e){var t=e.current;r.value=t})))})),function(e,t){return(0,n.openBlock)(),(0,n.createElementBlock)("div",w,[(0,n.createElementVNode)("div",x,(0,n.toDisplayString)(r.value.description),1)])}}});const D=(0,m.Z)(B,[["__scopeId","data-v-e4eb4f70"]]);var L=D,_=function(e){return(0,n.pushScopeId)("data-v-2b3100ca"),e=e(),(0,n.popScopeId)(),e},T={class:"container"},q=_((function(){return(0,n.createElementVNode)("div",{class:"block"},null,-1)})),E={class:"content"},P=(0,n.defineComponent)({__name:"GatewayNode",setup:function(e){var t=(0,n.inject)("getNode"),a=(0,n.ref)(),r=(0,n.ref)();return(0,n.onMounted)((function(){t&&(a.value=t(),r.value=a.value.data.id)})),function(e,t){var a=(0,n.resolveComponent)("Close"),o=(0,n.resolveComponent)("el-icon"),l=(0,n.resolveComponent)("Plus");return(0,n.openBlock)(),(0,n.createElementBlock)("div",T,[q,(0,n.createElementVNode)("div",E,["Exclusive"===r.value?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(a)]})),_:1})):(0,n.createCommentVNode)("",!0),"Parallel"===r.value?((0,n.openBlock)(),(0,n.createBlock)(o,{key:1},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(l)]})),_:1})):(0,n.createCommentVNode)("",!0)])])}}});const O=(0,m.Z)(P,[["__scopeId","data-v-2b3100ca"]]);var I=O,A={class:"container"},$={class:"block"},J=(0,n.defineComponent)({__name:"TaskNode",setup:function(e){var t=(0,n.inject)("getNode"),a=(0,n.ref)(),r=(0,n.ref)(),o={User:"UserFilled"};return(0,n.onMounted)((function(){t&&(a.value=t(),r.value=o[a.value.data.id])})),function(e,t){var a=(0,n.resolveComponent)("el-icon");return(0,n.openBlock)(),(0,n.createElementBlock)("div",A,[(0,n.createElementVNode)("div",$,[(0,n.createVNode)(a,null,{default:(0,n.withCtx)((function(){return[((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)(r.value)))]})),_:1})])])}}});const M=(0,m.Z)(J,[["__scopeId","data-v-59eba4b4"]]);var U,j=M,H=a(6303),R=a(3997),z=a(692),Z=function(e){(0,l.z2)((0,r.pi)({shape:e.name,width:200,height:50,component:h},e))},W=function(e){(0,l.z2)((0,r.pi)({shape:e.name,width:80,height:80,component:L},e))},G=function(e){(0,l.z2)((0,r.pi)({shape:e.name,width:100,height:100,component:k},e))},K=function(e){(0,l.z2)((0,r.pi)({shape:z.Bu,width:200,height:50,component:N},e))},X=!1,Q=function(){X||(X=!0,o.kJ.registerNode(z.xf,{inherit:"polygon",width:100,height:100,label:"决策组",attrs:{body:{strokeWidth:1,stroke:"#5F95FF",fill:"#FFF",refPoints:"0,10 10,0 20,10 10,20"},text:{fontSize:12,fill:"#262626"}},ports:(0,H.E)({portTemplates:[R.QX,R.gF]})}))},Y=function(e){(0,l.z2)((0,r.pi)({shape:z.gn,width:60,height:60,component:I},e))},ee=function(e){(0,l.z2)((0,r.pi)({shape:z.Xn,width:200,height:100,component:j},e))},te=(U={},U[z.Iu]=Z,U[z.WH]=W,U[z.hh]=G,U[z.Bu]=K,U[z.xf]=Q,U[z.gn]=Y,U[z.Xn]=ee,U),ae=(0,r.pi)({},te),re=function(e){e.forEach((function(e){ae[e.template](e.options)}))},oe=re;function le(e){e.forEach((function(e){var t,a={};a.ports=(0,H.E)({portTemplates:(null===(t=e.port)||void 0===t?void 0:t.templates)||[]}),a.name=e.name;var r=e.shape;oe([{template:r.template,options:a}])}))}},692:function(e,t,a){a.d(t,{Bu:function(){return n},Iu:function(){return r},WH:function(){return o},Xn:function(){return u},gn:function(){return s},hh:function(){return l},xf:function(){return i}});var r="basic-node",o="basic-logic-node",l="basic_or_node",n="basic_descision_node",i="basic_descision_group",s="gateway_node",u="task_node"},3997:function(e,t,a){a.d(t,{$g:function(){return i},BJ:function(){return d},DM:function(){return v},FJ:function(){return r},Hh:function(){return f},KP:function(){return m},Kc:function(){return h},QX:function(){return c},_F:function(){return g},cS:function(){return l},fw:function(){return o},gF:function(){return u},jH:function(){return n},jo:function(){return p},r_:function(){return s}});var r="output",o="input",l="condition",n=[r,l],i=[o],s="conditionPort",u="conditionOutPort",c="conditionInPort",d="actionPort",m="actionOutPort",p="actionInPort",h="basicOrPort",v="basicOrInPort",g="basicOrOutPort",f="basicOrConditionPort"},6303:function(e,t,a){a.d(t,{E:function(){return y}});var r,o,l,n,i,s,u=a(3997),c={circle:{r:4,magnet:!0,stroke:"#C2C8D5",strokeWidth:1,fill:"#fff"}},d=a(5934),m={groups:(r={},r[u.gF]={position:"right",attrs:c},r),items:[{group:u.gF,id:"".concat(u.r_,"-").concat(u.FJ,"-").concat((0,d.Z)())}]},p={groups:(o={},o[u.QX]={position:"left",attrs:c},o),items:[{group:u.QX,id:"".concat(u.r_,"-").concat(u.fw,"-").concat((0,d.Z)())}]},h={groups:(l={},l[u.KP]={position:"right",attrs:c},l),items:[{group:u.KP,id:"".concat(u.BJ,"-").concat(u.fw,"-").concat((0,d.Z)())}]},v={groups:(n={},n[u.jo]={position:"left",attrs:c},n),items:[{group:u.jo,id:"".concat(u.BJ,"-").concat(u.fw,"-").concat((0,d.Z)())}]},g={groups:(i={},i[u.DM]={position:"left",attrs:c},i[u._F]={position:"right",attrs:c},i[u.Hh]={position:"bottom",attrs:c},i),items:[{group:u.DM,id:"".concat(u.Kc,"-").concat(u.fw,"-").concat((0,d.Z)())},{group:u._F,id:"".concat(u.Kc,"-").concat(u.FJ,"-").concat((0,d.Z)())},{group:u.Hh,id:"".concat(u.Kc,"-").concat(u.cS,"-").concat((0,d.Z)())}]},f=(s={},s[u.gF]=m,s[u.QX]=p,s[u.Kc]=g,s[u.KP]=h,s[u.jo]=v,s),y=function(e){var t=e.portTemplates,a={groups:{},items:[]};return t&&t.forEach((function(e){a.items=Array.prototype.concat(a.items,f[e].items),a.groups=Object.assign({},a.groups,f[e].groups||{})})),a}},7489:function(e,t,a){a.d(t,{Z:function(){return x}});var r=a(8222);function o(e,t,a,o,l,n){const i=(0,r.resolveComponent)("ZoomIn"),s=(0,r.resolveComponent)("el-icon"),u=(0,r.resolveComponent)("el-tooltip"),c=(0,r.resolveComponent)("ZoomOut");return(0,r.openBlock)(),(0,r.createElementBlock)("div",null,[(0,r.createVNode)(u,{class:"item",effect:"dark",content:"放大",placement:"bottom"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(s,{onClick:t[0]||(t[0]=e=>n.zoomFn(.2))},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(i)])),_:1})])),_:1}),(0,r.createVNode)(u,{class:"item",effect:"dark",content:"缩小",placement:"bottom"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(s,{onClick:t[1]||(t[1]=e=>n.zoomFn(-.2))},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(c)])),_:1})])),_:1})])}var l=a(3634),n={props:{graph:l.kJ},methods:{zoomFn(e){this.graph&&this.graph.zoom(e)}}},i=a(3744);const s=(0,i.Z)(n,[["render",o]]);var u=s;function c(e,t,a,o,l,n){const i=(0,r.resolveComponent)("FullScreen"),s=(0,r.resolveComponent)("el-icon"),u=(0,r.resolveComponent)("el-tooltip");return(0,r.openBlock)(),(0,r.createBlock)(u,{class:"item",effect:"dark",content:"适应屏幕",placement:"bottom"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(s,{onClick:n.centerFn},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(i)])),_:1},8,["onClick"])])),_:1})}var d={props:{graph:l.kJ},methods:{centerFn(){if(this.graph){const e=1-this.graph.zoom();e>1?this.graph.zoom(-1*e):this.graph.zoom(e),this.graph.centerContent()}}}};const m=(0,i.Z)(d,[["render",c]]);var p=m,h=(0,r.defineComponent)({__name:"toolSave",props:{graph:null},emits:["saveData"],setup:function(e,t){var a=t.emit,o=e,l=function(){o.graph&&a("saveData",o.graph.toJSON({diff:!0}))};return function(e,t){var a=(0,r.resolveComponent)("UploadFilled"),o=(0,r.resolveComponent)("el-icon"),n=(0,r.resolveComponent)("el-tooltip");return(0,r.openBlock)(),(0,r.createBlock)(n,{class:"item",effect:"dark",content:"保存",placement:"bottom"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(o,{onClick:l},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(a)]})),_:1})]})),_:1})}}});const v=h;var g=v;function f(e,t,a,o,l,n){const i=(0,r.resolveComponent)("Lock"),s=(0,r.resolveComponent)("el-icon"),u=(0,r.resolveComponent)("Unlock"),c=(0,r.resolveComponent)("el-tooltip");return(0,r.openBlock)(),(0,r.createBlock)(c,{class:"item",effect:"dark",content:"是否禁用",placement:"bottom"},{default:(0,r.withCtx)((()=>[l.isLock?((0,r.openBlock)(),(0,r.createBlock)(s,{key:1,onClick:n.lockFn},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(u)])),_:1},8,["onClick"])):((0,r.openBlock)(),(0,r.createBlock)(s,{key:0,onClick:n.lockFn},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(i)])),_:1},8,["onClick"]))])),_:1})}var y={props:{graph:l.kJ},data(){return{isLock:!1}},methods:{lockFn:function(){this.isLock=!this.isLock,this.isLock&&this.graph?(this.graph.enablePanning(),this.graph.enableKeyboard()):this.graph&&(this.graph.disablePanning(),this.graph.disableKeyboard())}}};const k=(0,i.Z)(y,[["render",f]]);var V,C=k,F=a(719),S=(V={},V[F.kq]=u,V[F.nk]=p,V[F.K3]=g,V[F.yo]=C,V),b={class:"graph-tools__block"},N=(0,r.defineComponent)({__name:"index",props:{tools:null},setup:function(e){return function(t,a){return(0,r.openBlock)(),(0,r.createElementBlock)("div",b,[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.tools,(function(e){return(0,r.openBlock)(),(0,r.createBlock)((0,r.resolveDynamicComponent)((0,r.unref)(S)[e]),(0,r.mergeProps)({class:"graph-tools__item"},t.$attrs,{key:e}),null,16)})),128))])}}});const w=(0,i.Z)(N,[["__scopeId","data-v-42c48e2a"]]);var x=w},8358:function(e,t,a){a.r(t),a.d(t,{default:function(){return de}});var r=a(655),o=a(8222),l=a(8917),n=a(5991),i=a(8116),s=a(6941);function u(){var e=(0,o.ref)(),t=(0,o.ref)();return(0,o.onMounted)((function(){e.value=(0,s.j)({templateName:i.ef,container:document.getElementById("container")}),t.value=(0,l.m)(e.value),(0,n.U)(e.value,["copy","paste","cut","undo","redo","delete"])})),{graph:e,dnd:t}}const c=e=>((0,o.pushScopeId)("data-v-420c16b9"),e=e(),(0,o.popScopeId)(),e),d=c((()=>(0,o.createElementVNode)("div",null,null,-1))),m={class:"class-fold"},p=c((()=>(0,o.createElementVNode)("i",{class:"el-icon-arrow-up"},null,-1))),h=[p],v={key:0,class:"fold-content"};function g(e,t,a,r,l,n){return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[d,(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("div",{class:"fold-title",onClick:t[0]||(t[0]=e=>l.foldShow=!l.foldShow)},[(0,o.createTextVNode)((0,o.toDisplayString)(a.name)+" ",1),(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(["icon-fold",{"fold-show":!l.foldShow}])},h,2)]),l.foldShow?((0,o.openBlock)(),(0,o.createElementBlock)("div",v,[(0,o.renderSlot)(e.$slots,"default",{},void 0,!0)])):(0,o.createCommentVNode)("",!0)])],64)}var f={name:"ClassFold",props:{name:{type:String,required:!0,default:""},fold:{type:Boolean,required:!1,default:!1}},data(){return{foldShow:!1}},created(){this.foldShow=this.fold}},y=a(3744);const k=(0,y.Z)(f,[["render",g],["__scopeId","data-v-420c16b9"]]);var V=k,C={class:"menu-item"},F={class:"element-list"},S=["onMousedown"],b=["src"],N=(0,o.defineComponent)({__name:"MenuItem",props:{menuList:null,dnd:null},setup:function(e){var t=e,a=(0,o.inject)("graph",(0,o.ref)(void 0)),n=function(e,o){a.value&&t.dnd&&(0,l.d)({graph:a.value,dnd:t.dnd,event:e,options:{shape:o.name},data:(0,r.pi)({},o)})};return function(t,a){return(0,o.openBlock)(),(0,o.createElementBlock)("div",C,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.menuList,(function(e,t){return(0,o.openBlock)(),(0,o.createBlock)(V,{key:e.classCode+t,name:e.className,fold:!0},{default:(0,o.withCtx)((function(){return[(0,o.createElementVNode)("div",F,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.children,(function(e){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{key:e.id,class:"element-item",draggable:"true",onMousedown:function(t){return n(t,e)}},[(0,o.createElementVNode)("img",{src:e.icon},null,8,b),(0,o.createElementVNode)("div",null,(0,o.toDisplayString)(e.description),1)],40,S)})),128))])]})),_:2},1032,["name"])})),128))])}}});const w=(0,y.Z)(N,[["__scopeId","data-v-0a1cba7a"]]);var x=w,B=a(1868),D=function(){return(0,B.U)("get","/developerportal/developer/component/cmptPropList/TIMER",{})},L=function(){return(0,B.U)("get","/developerportal/developer/component/cmptPropList/WEATHER",{})},_=function(){return(0,B.U)("get","/developerportal/developer/component/cmptPropList/GEOFENCE",{})},T=function(){return(0,B.U)("get","/developerportal/developer/component/cmptPropList/DELAY",{})},q=a(692),E=a(8503),P=a(6454),O=a(3927),I=a(3997),A=a(2201),$=a(6303);function J(e,t){var a=t.query.id,r=t.query.name,o=t.name;if("createDescisionNode"===o){var l=JSON.parse(localStorage.getItem("descisionNode")||"{}")[a];l&&e.fromJSON(l)}if("createDescisionGroup"===o){var n=JSON.parse(localStorage.getItem("descisionGroup")||"{}")[a];n&&e.fromJSON(n)}if("rulesDetail"===o&&a){var i=JSON.parse(localStorage.getItem("graphData")||"{}");e.fromJSON(i[a])}if("createFlow"===o){i=JSON.parse(localStorage.getItem("flow")||"{}");i[a]?e.fromJSON(i[a]):e.addNode({shape:"rect",x:100,y:40,width:100,height:40,attrs:{text:{text:r}},ports:(0,$.E)({portTemplates:[I.gF]})})}}function M(e){var t=(0,A.yj)(),a=(0,o.ref)(P.Jl),l=(0,o.ref)(P.RR),n=(0,o.ref)(P.Kg),i=(0,o.ref)(P.O),s=(0,o.ref)([]),u=JSON.parse(localStorage.getItem("config")||"[]");u.length&&a.value.push({className:"自定义组件",classCode:"self",children:u});var c=(0,o.ref)([]);return Promise.all([D(),L(),_(),T()]).then((function(u){var c=u[0],d=u[1],m=u[2],p=u[3];c&&c.data&&(a.value[1].children=c.data.map((function(e){return(0,r.pi)((0,r.pi)({},e),{shape:{template:q.Iu},attr:{template:E.fg}})}))),d&&d.data&&(a.value[2].children=d.data.map((function(e){return(0,r.pi)((0,r.pi)({},e),{shape:{template:q.Iu},attr:{template:E.HT}})}))),m&&m.data&&(a.value[3].children=m.data.map((function(e){return(0,r.pi)((0,r.pi)({},e),{shape:{template:q.Iu},attr:{template:E.hI}})}))),p&&p.data&&(n.value[2].children=p.data.map((function(e){return(0,r.pi)((0,r.pi)({},e),{shape:{template:q.Iu},port:{templates:[I.gF,I.QX]},attr:{template:E.m8}})}))),(0,r.ev)((0,r.ev)((0,r.ev)((0,r.ev)([],a.value,!0),l.value,!0),n.value,!0),i.value,!0).forEach((function(e){var t;(t=s.value).push.apply(t,e.children)})),(0,O.Z)(s.value),(0,o.watch)(e,(function(e){e&&J(e,t)}),{immediate:!0})})),"createDescisionNode"===t.name?c.value=(0,r.ev)([],a.value,!0):"createFlow"===t.name?c.value=(0,r.ev)((0,r.ev)([],n.value,!0),i.value,!0):"createDescisionGroup"===t.name&&(c.value=l.value),{renderList:c}}var U={class:"material-content"},j=(0,o.defineComponent)({__name:"index",setup:function(e){var t=(0,o.inject)("graph"),a=M(t),r=a.renderList,l=(0,o.ref)(["condition","action","logic"]),n=function(){console.log("world")};return function(e,t){var a=(0,o.resolveComponent)("el-collapse-item"),i=(0,o.resolveComponent)("el-collapse");return(0,o.openBlock)(),(0,o.createElementBlock)("div",U,[(0,o.createVNode)(i,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=function(e){return l.value=e}),onChange:n},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(a,{title:"决策组件",name:"condition"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(x,(0,o.mergeProps)(e.$attrs,{"menu-list":(0,o.unref)(r)}),null,16,["menu-list"])]})),_:1})]})),_:1},8,["modelValue"])])}}});const H=(0,y.Z)(j,[["__scopeId","data-v-95806a10"]]);var R=H,z=a(7489),Z=a(719),W=a(1803),G={class:"attribute-block"},K={class:"attribute-title"},X=["src"],Q=(0,o.defineComponent)({__name:"index",props:{node:null},setup:function(e){var t=e,a=(0,o.computed)((function(){return r.value.attr?(0,W.E)(r.value.attr):null})),r=(0,o.computed)((function(){return t.node&&t.node.data||{}}));return function(e,t){return(0,o.openBlock)(),(0,o.createElementBlock)("div",G,[(0,o.createElementVNode)("div",K,[(0,o.createElementVNode)("img",{src:(0,o.unref)(r).icon,alt:""},null,8,X),(0,o.createElementVNode)("h4",null,(0,o.toDisplayString)((0,o.unref)(r).description),1)]),(0,o.unref)(a)?((0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)((0,o.unref)(a)),(0,o.normalizeProps)((0,o.mergeProps)({key:0},e.$attrs)),null,16)):(0,o.createCommentVNode)("",!0)])}}});const Y=(0,y.Z)(Q,[["__scopeId","data-v-af3eae30"]]);var ee=Y,te=a(1348);function ae(e,t){var a=t.name,r=t.query.id,o=!1;if("createDescisionNode"===a){var l=JSON.parse(localStorage.getItem("descisionNode")||"{}");l[r]=e,localStorage.setItem("descisionNode",JSON.stringify(l)),o=!0}if("createDescisionGroup"===a){var n=JSON.parse(localStorage.getItem("descisionGroup")||"{}");n[r]=e,console.log("当前决策组内容是",e),localStorage.setItem("descisionGroup",JSON.stringify(n)),o=!0}if("createFlow"===a){var i=JSON.parse(localStorage.getItem("flow")||"{}");i[r]=e,localStorage.setItem("flow",JSON.stringify(i)),o=!0}o&&(0,te.z8)({message:"保存成功",type:"success"})}var re=function(e){return(0,o.pushScopeId)("data-v-ae655140"),e=e(),(0,o.popScopeId)(),e},oe={class:"home"},le={class:"menu-bar"},ne={class:"canvas-card"},ie=re((function(){return(0,o.createElementVNode)("div",{id:"container"},null,-1)})),se={class:"attrs-bar"},ue=(0,o.defineComponent)({__name:"index",setup:function(e){var t=(0,A.yj)(),a=u(),l=a.graph,n=a.dnd;(0,o.provide)("graph",l);var i=(0,o.ref)(),s=(0,o.ref)(),c=function(){l.value&&l.value.removeNode(i.value),i.value=void 0},d=function(e){if(i.value)if(i.value.shape===q.xf)i.value.attr("text/text",e.descision);else{var t=i.value.getData();i.value.setData((0,r.pi)((0,r.pi)({},t),{attrData:e}))}},m=function(e){console.log("保存的数据是",e),ae(e,t,l.value)},p=[Z.kq,Z.nk,Z.K3,Z.yo],h=function(e,t){for(var a=0,r=e.length;a<r;a+=1)e[a].style.visibility=t?"visible":"hidden"};return(0,o.onMounted)((function(){l.value&&n.value&&(l.value.on("node:click",(function(e){var t=e.view,a=e.node;s.value&&s.value.classList.remove("active"),s.value=t.container.querySelector(".basic-node")||void 0,s.value&&s.value.classList.add("active"),i.value?i.value!==a?i.value=a:i.value=void 0:i.value=a})),l.value.on("blank:click",(function(){i.value=void 0,s.value&&s.value.classList.remove("active")})),l.value.on("node:mouseenter",(function(){var e=document.getElementById("container"),t=e.querySelectorAll(".x6-port-body");h(t,!0)})),l.value.on("node:mouseleave",(function(){var e=document.getElementById("container"),t=e.querySelectorAll(".x6-port-body");h(t,!1)})))})),function(e,t){return(0,o.openBlock)(),(0,o.createElementBlock)("div",oe,[(0,o.createElementVNode)("div",le,[(0,o.createVNode)(R,{dnd:(0,o.unref)(n)},null,8,["dnd"])]),(0,o.createElementVNode)("div",ne,[(0,o.createElementVNode)("header",null,[(0,o.createVNode)(z.Z,{tools:p,graph:(0,o.unref)(l),onSaveData:m},null,8,["graph"])]),ie]),(0,o.withDirectives)((0,o.createElementVNode)("div",se,[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(ee,{key:(0,o.unref)(i)&&(0,o.unref)(i).id,node:(0,o.unref)(i),onSyncData:d,onDelNode:c},null,8,["node"])),[[o.vShow,(0,o.unref)(i)]])],512),[[o.vShow,(0,o.unref)(i)]])])}}});const ce=(0,y.Z)(ue,[["__scopeId","data-v-ae655140"]]);var de=ce}},t={};function a(r){var o=t[r];if(void 0!==o)return o.exports;var l=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(l.exports,l,l.exports,a),l.loaded=!0,l.exports}a.m=e,function(){var e=[];a.O=function(t,r,o,l){if(!r){var n=1/0;for(c=0;c<e.length;c++){r=e[c][0],o=e[c][1],l=e[c][2];for(var i=!0,s=0;s<r.length;s++)(!1&l||n>=l)&&Object.keys(a.O).every((function(e){return a.O[e](r[s])}))?r.splice(s--,1):(i=!1,l<n&&(n=l));if(i){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[r,o,l]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,r){return a.f[r](e,t),t}),[]))}}(),function(){a.u=function(e){return"assets/js/"+{239:"flow",624:"LogicFlow"}[e]+"."+{239:"46286c3c",624:"9481e8b5"}[e]+".js"}}(),function(){a.miniCssF=function(e){return"assets/css/"+{239:"flow",624:"LogicFlow"}[e]+"."+{239:"7891bde2",624:"d4de6f9a"}[e]+".css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="scenes:";a.l=function(r,o,l,n){if(e[r])e[r].push(o);else{var i,s;if(void 0!==l)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+l){i=d;break}}i||(s=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",t+l),i.src=r),e[r]=[o];var m=function(t,a){i.onerror=i.onload=null,clearTimeout(p);var o=e[r];if(delete e[r],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach((function(e){return e(a)})),t)return t(a)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=m.bind(null,i.onerror),i.onload=m.bind(null,i.onload),s&&document.head.appendChild(i)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){a.p="/scenes/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,a,r,o){var l=document.createElement("link");l.rel="stylesheet",l.type="text/css";var n=function(a){if(l.onerror=l.onload=null,"load"===a.type)r();else{var n=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.href||t,s=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");s.code="CSS_CHUNK_LOAD_FAILED",s.type=n,s.request=i,l.parentNode.removeChild(l),o(s)}};return l.onerror=l.onload=n,l.href=t,a?a.parentNode.insertBefore(l,a.nextSibling):document.head.appendChild(l),l},t=function(e,t){for(var a=document.getElementsByTagName("link"),r=0;r<a.length;r++){var o=a[r],l=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(l===e||l===t))return o}var n=document.getElementsByTagName("style");for(r=0;r<n.length;r++){o=n[r],l=o.getAttribute("data-href");if(l===e||l===t)return o}},r=function(r){return new Promise((function(o,l){var n=a.miniCssF(r),i=a.p+n;if(t(n,i))return o();e(r,i,null,o,l)}))},o={143:0};a.f.miniCss=function(e,t){var a={239:1,624:1};o[e]?t.push(o[e]):0!==o[e]&&a[e]&&t.push(o[e]=r(e).then((function(){o[e]=0}),(function(t){throw delete o[e],t})))}}}(),function(){var e={143:0};a.f.j=function(t,r){var o=a.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var l=new Promise((function(a,r){o=e[t]=[a,r]}));r.push(o[2]=l);var n=a.p+a.u(t),i=new Error,s=function(r){if(a.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var l=r&&("load"===r.type?"missing":r.type),n=r&&r.target&&r.target.src;i.message="Loading chunk "+t+" failed.\n("+l+": "+n+")",i.name="ChunkLoadError",i.type=l,i.request=n,o[1](i)}};a.l(n,s,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,l,n=r[0],i=r[1],s=r[2],u=0;if(n.some((function(t){return 0!==e[t]}))){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(s)var c=s(a)}for(t&&t(r);u<n.length;u++)l=n[u],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(c)},r=self["webpackChunkscenes"]=self["webpackChunkscenes"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=a.O(void 0,[998],(function(){return a(9275)}));r=a.O(r)})();
//# sourceMappingURL=app.1e51140d.js.map