// StartEvent.ts

import { HBPMN_TIMER_START_EVENT } from "./constants";
import { CircleNode, CircleNodeModel, h } from "@logicflow/core";

class StartEventModel extends CircleNodeModel {
  initNodeData(data: any) {
    super.initNodeData(data);
    this.text.value = this.text.value || "定时事件";
    this.text.editable = true;
    this.text.x = this.x;
    this.text.y = this.y + this.r;
    this.r = 30;
  }
}
class StartEventView extends CircleNode {
  private getLabelShape() {
    const { model } = this.props;
    const { x, y, width, height } = model;
    const style = model.getNodeStyle();
    return h(
      "svg",
      {
        x: x - width / 2 + 6,
        y: y - height / 2,
        width: 60,
        height: 60,
        viewBox: "0 0 1274 1024",
      },
      [
        h("path", {
          fill: style.stroke,
          d: "M827.871087 196.128913C743.498468 111.756293 631.321596 65.290005 512 65.290005c-119.319549 0-231.499491 46.465265-315.871087 130.837884S65.290005 392.680451 65.290005 512s46.465265 231.499491 130.837884 315.871087 196.551538 130.837884 315.871087 130.837884c119.321596 0 231.499491-46.465265 315.871087-130.837884S958.708971 631.319549 958.708971 512 912.243707 280.500509 827.871087 196.128913zM531.556405 917.246651l0-74.145697c0-11.31572-9.174963-20.491707-20.491707-20.491707-11.316743 0-20.491707 9.174963-20.491707 20.491707l0 74.059739C283.276738 906.322857 116.693746 739.164766 106.755396 531.634176l72.351841 0c11.31572 0 20.491707-9.174963 20.491707-20.491707 0-11.31572-9.174963-20.491707-20.491707-20.491707l-72.273047 0c10.769274-206.737528 177.01253-373.005342 383.740848-383.813502l0 72.346725c0 11.316743 9.174963 20.491707 20.491707 20.491707 11.31572 0 20.491707-9.17394 20.491707-20.491707L531.558451 106.752326c207.593012 9.901511 374.807385 176.539762 385.609405 383.89946l-74.142627 0c-11.316743 0-20.491707 9.174963-20.491707 20.491707 0 11.316743 9.174963 20.491707 20.491707 20.491707l74.220399 0C907.275555 739.78796 739.720422 907.317511 531.556405 917.246651z",
        }),
        h("path", {
          fill: style.stroke,
          d: "M532.098757 503.118726 532.098757 258.240529c0-11.316743-9.174963-20.491707-20.491707-20.491707-11.31572 0-20.491707 9.17394-20.491707 20.491707l0 254.66612c0 7.858992 4.429893 14.677281 10.924817 18.114566L693.447539 722.42757c4.002151 4.000104 9.245572 6.001691 14.490016 6.001691s10.487865-2.001587 14.490016-6.001691c8.002254-8.002254 8.002254-20.977777 0-28.980032L532.098757 503.118726z",
        }),
        // h("path", {
        //   fill: style.stroke,
        //   d: "M602.965333 882.176A381.098667 381.098667 0 1 1 512 130.901333a382.976 382.976 0 0 1 376.832 324.266667 17.066667 17.066667 0 0 0 19.456 14.336 17.066667 17.066667 0 0 0 14.336-19.456A415.232 415.232 0 1 0 512 927.232a420.181333 420.181333 0 0 0 99.157333-11.776 17.066667 17.066667 0 0 0 12.458667-20.650667 17.066667 17.066667 0 0 0-20.650667-12.629333z",
        // }),
        // h("path", {
        //   fill: style.stroke,
        //   d: "M543.402667 732.330667a17.066667 17.066667 0 1 0 0-34.133334h-62.805334a17.066667 17.066667 0 1 0 0 34.133334z",
        // }),
        // h("path", {
        //   fill: style.stroke,
        //   d: "M603.989333 816.810667a317.44 317.44 0 0 1-74.922666 12.8v-24.234667a17.066667 17.066667 0 0 0-34.133334 0v24.064a316.074667 316.074667 0 0 1-126.976-34.133333l12.117334-20.821334a17.066667 17.066667 0 1 0-29.525334-17.066666l-12.117333 20.821333a320.853333 320.853333 0 0 1-92.842667-92.842667l20.821334-12.117333a17.066667 17.066667 0 1 0-17.066667-29.525333l-20.821333 12.117333a316.074667 316.074667 0 0 1-34.133334-126.976h24.064a17.066667 17.066667 0 1 0 0-34.133333h-23.893333a316.074667 316.074667 0 0 1 34.133333-126.976l20.821334 12.117333a17.066667 17.066667 0 1 0 17.066666-29.525333l-20.821333-12.117334a320.853333 320.853333 0 0 1 92.842667-92.842666l12.117333 20.821333a17.066667 17.066667 0 1 0 29.525333-17.066667l-12.117333-20.821333a316.074667 316.074667 0 0 1 126.976-34.133333v24.064a17.066667 17.066667 0 1 0 34.133333 0V194.56a314.88 314.88 0 0 1 126.976 34.133333l-12.117333 20.821334a17.066667 17.066667 0 1 0 29.525333 17.066666l12.117334-20.821333a319.317333 319.317333 0 0 1 93.013333 92.842667l-20.992 12.117333a17.066667 17.066667 0 1 0 17.066667 29.525333l20.992-12.117333a312.832 312.832 0 0 1 29.013333 84.138667 17.066667 17.066667 0 1 0 34.133333-6.314667A352.256 352.256 0 1 0 614.4 849.408a17.066667 17.066667 0 0 0 11.434667-21.162667 17.066667 17.066667 0 0 0-21.845334-11.434666z",
        // }),
        // h("path", {
        //   fill: style.stroke,
        //   d: "M603.989333 816.810667a317.44 317.44 0 0 1-74.922666 12.8v-24.234667a17.066667 17.066667 0 0 0-34.133334 0v24.064a316.074667 316.074667 0 0 1-126.976-34.133333l12.117334-20.821334a17.066667 17.066667 0 1 0-29.525334-17.066666l-12.117333 20.821333a320.853333 320.853333 0 0 1-92.842667-92.842667l20.821334-12.117333a17.066667 17.066667 0 1 0-17.066667-29.525333l-20.821333 12.117333a316.074667 316.074667 0 0 1-34.133334-126.976h24.064a17.066667 17.066667 0 1 0 0-34.133333h-23.893333a316.074667 316.074667 0 0 1 34.133333-126.976l20.821334 12.117333a17.066667 17.066667 0 1 0 17.066666-29.525333l-20.821333-12.117334a320.853333 320.853333 0 0 1 92.842667-92.842666l12.117333 20.821333a17.066667 17.066667 0 1 0 29.525333-17.066667l-12.117333-20.821333a316.074667 316.074667 0 0 1 126.976-34.133333v24.064a17.066667 17.066667 0 1 0 34.133333 0V194.56a314.88 314.88 0 0 1 126.976 34.133333l-12.117333 20.821334a17.066667 17.066667 0 1 0 29.525333 17.066666l12.117334-20.821333a319.317333 319.317333 0 0 1 93.013333 92.842667l-20.992 12.117333a17.066667 17.066667 0 1 0 17.066667 29.525333l20.992-12.117333a312.832 312.832 0 0 1 29.013333 84.138667 17.066667 17.066667 0 1 0 34.133333-6.314667A352.256 352.256 0 1 0 614.4 849.408a17.066667 17.066667 0 0 0 11.434667-21.162667 17.066667 17.066667 0 0 0-21.845334-11.434666z",
        // }),
        // h("path", {
        //   fill: style.stroke,
        //   d: "M512 491.008A20.992 20.992 0 1 0 532.992 512 20.992 20.992 0 0 0 512 491.008z",
        // }),
        // h("path", {
        //   fill: style.stroke,
        //   d: "M565.76 571.050667A80.042667 80.042667 0 0 0 592.213333 512a74.410667 74.410667 0 0 0-1.194666-10.581333l110.08-109.909334a48.469333 48.469333 0 1 0-68.266667-68.266666l-109.909333 110.08a74.410667 74.410667 0 0 0-10.922667-1.536 75.605333 75.605333 0 0 0-21.504 3.413333l-91.648-69.12A48.469333 48.469333 0 1 0 341.333333 443.733333l91.477334 68.266667A80.213333 80.213333 0 0 0 512 592.213333a76.117333 76.117333 0 0 0 24.234667-4.266666l78.336 136.533333a17.066667 17.066667 0 0 0 29.525333-17.066667z m90.794667-223.914667a14.336 14.336 0 0 1 20.309333 20.309333l-98.986667 98.986667a82.090667 82.090667 0 0 0-20.309333-20.309333zM440.661333 476.16l-79.530666-59.904a14.336 14.336 0 1 1 17.066666-22.869333l79.530667 59.904a83.968 83.968 0 0 0-17.066667 22.869333zM512 558.08a46.08 46.08 0 1 1 46.08-46.08 46.08 46.08 0 0 1-46.08 46.08z",
        // }),
        // h("path", {
        //   fill: style.stroke,
        //   d: "M892.586667 646.314667v-30.72a34.133333 34.133333 0 0 0 34.133333-34.133334v-39.765333a17.066667 17.066667 0 0 0-17.066667-17.066667H681.642667a17.066667 17.066667 0 0 0-17.066667 17.066667v39.765333a34.133333 34.133333 0 0 0 34.133333 34.133334v30.72a96.597333 96.597333 0 0 0 41.984 79.530666A97.109333 97.109333 0 0 0 699.733333 805.546667V836.266667a34.133333 34.133333 0 0 0-34.133333 34.133333v39.765333a17.066667 17.066667 0 0 0 17.066667 17.066667h227.498666a17.066667 17.066667 0 0 0 17.066667-17.066667V870.4a34.133333 34.133333 0 0 0-34.133333-34.133333v-30.72a97.109333 97.109333 0 0 0-41.813334-79.701334 96.426667 96.426667 0 0 0 41.301334-79.530666z m-193.877334-64.853334v-22.698666h194.389334v22.698666zM893.098667 870.4v22.698667H698.709333V870.4z m-34.133334-64.853333V836.266667H733.866667v-30.72a62.634667 62.634667 0 1 1 125.098666 0z m0-159.232a62.634667 62.634667 0 0 1-125.098666 0v-30.72h124.586666z",
        // }),
      ]
    );
  }
  /**
   * 完全自定义节点外观方法
   */
  getShape() {
    const { model } = this.props;
    const { width, height, r, x, y } = model;
    const style = model.getNodeStyle();
    return h("g", {}, [
      h("circle", {
        ...style,
        r,
        cx: x,
        cy: y,
        width,
        height,
      }),
      this.getLabelShape(),
    ]);
  }
}

export default {
  type: HBPMN_TIMER_START_EVENT,
  view: StartEventView,
  model: StartEventModel,
};
